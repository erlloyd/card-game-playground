(this["webpackJsonpcard-game-playground"]=this["webpackJsonpcard-game-playground"]||[]).push([[0],{140:function(e){e.exports=JSON.parse('[{"code":"rhino","name":"Rhino","card_set_type_code":"villain"},{"code":"klaw","name":"Klaw","card_set_type_code":"villain"},{"code":"ultron","name":"Ultron","card_set_type_code":"villain"},{"code":"she_hulk_nemesis","name":"She-Hulk Nemesis","card_set_type_code":"nemesis"},{"code":"iron_man_nemesis","name":"Iron Man Nemesis","card_set_type_code":"nemesis"},{"code":"spider_man_nemesis","name":"Spider-Man Nemesis","card_set_type_code":"nemesis"},{"code":"black_panther_nemesis","name":"Black Panther Nemesis","card_set_type_code":"nemesis"},{"code":"captain_marvel_nemesis","name":"Captain Marvel Nemesis","card_set_type_code":"nemesis"},{"code":"she_hulk","name":"She-Hulk","card_set_type_code":"hero"},{"code":"iron_man","name":"Iron Man","card_set_type_code":"hero"},{"code":"spider_man","name":"Spider-Man","card_set_type_code":"hero"},{"code":"black_panther","name":"Black Panther","card_set_type_code":"hero"},{"code":"captain_marvel","name":"Captain Marvel","card_set_type_code":"hero"},{"code":"bomb_scare","name":"Bomb Scare","card_set_type_code":"modular"},{"code":"standard","name":"Standard","card_set_type_code":"standard"},{"code":"expert","name":"Expert","card_set_type_code":"expert"},{"code":"masters_of_evil","name":"Masters of Evil","card_set_type_code":"modular"},{"code":"under_attack","name":"Under Attack","card_set_type_code":"modular"},{"code":"legions_of_hydra","name":"Legions of Hydra","card_set_type_code":"modular"},{"code":"the_doomsday_chair","name":"The Doomsday Chair","card_set_type_code":"modular"},{"code":"risky_business","name":"Risky Business","card_set_type_code":"villain"},{"code":"mutagen_formula","name":"Mutagen Formula","card_set_type_code":"villain"},{"code":"goblin_gimmicks","name":"Goblin Gimmicks","card_set_type_code":"modular"},{"code":"running_interference","name":"Running Interference","card_set_type_code":"modular"},{"code":"power_drain","name":"Power Drain","card_set_type_code":"modular"},{"code":"a_mess_of_things","name":"A Mess of Things","card_set_type_code":"modular"},{"code":"captain_america","name":"Captain America","card_set_type_code":"hero"},{"code":"captain_america_nemesis","name":"Captain America Nemesis","card_set_type_code":"nemesis"},{"code":"ms_marvel","name":"Ms. Marvel","card_set_type_code":"hero"},{"code":"ms_marvel_nemesis","name":"Ms. Marvel Nemesis","card_set_type_code":"nemesis"},{"code":"thor","name":"Thor","card_set_type_code":"hero"},{"code":"thor_nemesis","name":"Thor Nemesis","card_set_type_code":"nemesis"},{"code":"wrecking_crew","name":"Wrecking Crew","card_set_type_code":"villain"},{"code":"piledriver","name":"Piledriver","card_set_type_code":"villain"},{"code":"wrecker","name":"Wrecker","card_set_type_code":"villain"},{"code":"thunderball","name":"Thunderball","card_set_type_code":"villain"},{"code":"bulldozer","name":"Bulldozer","card_set_type_code":"villain"},{"code":"black_widow","name":"Black Widow","card_set_type_code":"hero"},{"code":"black_widow_nemesis","name":"Black Widow Nemesis","card_set_type_code":"nemesis"},{"code":"doctor_strange","name":"Doctor Strange","card_set_type_code":"hero"},{"code":"invocation","name":"Invocation","card_set_type_code":"hero"},{"code":"doctor_strange_nemesis","name":"Doctor Strange Nemesis","card_set_type_code":"nemesis"},{"code":"hulk","name":"Hulk","card_set_type_code":"hero"},{"code":"hulk_nemesis","name":"Hulk Nemesis","card_set_type_code":"nemesis"},{"code":"kree_fanatic","name":"Kree Fanatic","card_set_type_code":"modular"},{"code":"hawkeye","name":"Hawkeye","card_set_type_code":"hero"},{"code":"hawkeye_nemesis","name":"Hawkeye Nemesis","card_set_type_code":"nemesis"},{"code":"spider_woman","name":"Spider-Woman","card_set_type_code":"hero"},{"code":"spider_woman_nemesis","name":"Spider-Woman Nemesis","card_set_type_code":"nemesis"},{"code":"crossbones","name":"Crossbones","card_set_type_code":"villain"},{"code":"exper_weapon","name":"Experimental Weapons","card_set_type_code":"modular"},{"code":"absorbing_man","name":"Absorbing Man","card_set_type_code":"villain"},{"code":"taskmaster","name":"Taskmaster","card_set_type_code":"villain"},{"code":"zola","name":"Zola","card_set_type_code":"villain"},{"code":"red_skull","name":"Red Skull","card_set_type_code":"villain"},{"code":"hydra_assault","name":"Hydra Assault","card_set_type_code":"modular"},{"code":"weap_master","name":"Weapon Master","card_set_type_code":"modular"},{"code":"hydra_patrol","name":"Hydra Patrol","card_set_type_code":"modular"},{"code":"hydra_camp","name":"Hydra Campaign","card_set_type_code":"modular"},{"code":"expcamp","name":"Expert Campaign","card_set_type_code":"modular"},{"code":"kang","name":"Kang","card_set_type_code":"villain"},{"code":"temporal","name":"Temporal","card_set_type_code":"modular"},{"code":"exp_kang","name":"Expert Kang","card_set_type_code":"modular"},{"code":"anchronauts","name":"Anachronauts","card_set_type_code":"modular"},{"code":"mot","name":"Master of Time","card_set_type_code":"modular"},{"code":"ant","name":"Ant-Man","card_set_type_code":"hero"},{"code":"ant_nemesis","name":"Ant-Man Nemesis","card_set_type_code":"nemesis"},{"code":"wsp","name":"Wasp","card_set_type_code":"hero"},{"code":"wsp_nemesis","name":"Wasp Nemesis","card_set_type_code":"nemesis"},{"code":"qsv","name":"Quicksilver","card_set_type_code":"hero"},{"code":"qsv_nemesis","name":"Quicksilver Nemesis","card_set_type_code":"nemesis"},{"code":"scw","name":"Scarlet Witch","card_set_type_code":"hero"},{"code":"scw_nemesis","name":"Scarlet Witch Nemesis","card_set_type_code":"nemesis"}]')},172:function(e,t,o){},198:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id=198},277:function(e,t,o){},278:function(e,t,o){},279:function(e,t,o){},280:function(e,t,o){},281:function(e,t,o){"use strict";o.r(t);var a=o(2),n=o(0),r=o.n(n),s=o(17),i=o.n(s),d=(o(172),o(24));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,l=o(139),u=o.n(l),h=o(15),p=o(30),g=o(46),m=o.n(g),f=o(322),C=Object(f.a)();!function(e){e.MarvelChampions="marvelchampions",e.LordOfTheRingsLivingCardGame="lotrlcg"}(c||(c={}));var T,v=["red","cyan","green","blue","magenta","yellow"],y=o(27),b=function(e){try{var t,o=localStorage.getItem(e);if(null===o)return{};var a=JSON.parse(o||"{}");return null!==(t=a.present)&&void 0!==t?t:a}catch(n){return console.error("problem parsing"),{}}},S={activeDataType:null!==(T=b("game").activeGameType)&&void 0!==T?T:c.MarvelChampions,data:{}},j=o(140),k=o(79),x=Object(h.b)("resetAction"),O=Object(h.b)("receiveRemoteGameState"),w=o(13),P=b("game");P.playerColors={},P.playerColors[C]="red",P.peerId="",P.previewCard=null,P.menuPreviewCardJsonId=null;var _,I,M=Object(w.a)(Object(w.a)({},{playerColors:{},stageZoom:{x:.5,y:.5},stagePosition:{x:0,y:0},peerId:"",previewCard:null,menuPreviewCardJsonId:null,activeGameType:null}),P),D=Object(h.d)({name:"game",initialState:M,reducers:{updateZoom:function(e,t){return e.stageZoom=t.payload,e},updatePosition:function(e,t){return e.stagePosition=t.payload,e},connectToRemoteGame:function(){},setPlayerColor:function(e,t){e.playerColors[t.payload.ref]=t.payload.color},setPeerId:function(e,t){e.peerId=t.payload},requestResync:function(){},setPreviewCardId:function(e,t){e.previewCard?e.previewCard.id!==t.payload&&(e.previewCard.id=t.payload):e.previewCard={id:t.payload}},clearPreviewCard:function(e){e.previewCard=null},setMenuPreviewCardJsonId:function(e,t){e.menuPreviewCardJsonId=t.payload},clearMenuPreviewCardJsonId:function(e){e.menuPreviewCardJsonId=null},updateActiveGameType:function(e,t){e.activeGameType=t.payload},quitGame:function(e){e.activeGameType=null}},extraReducers:function(e){e.addCase(O,(function(e,t){e.activeGameType=t.payload.game.activeGameType})),e.addCase(x,(function(e,t){e.stagePosition={x:0,y:0},e.stageZoom={x:.5,y:.5},e.previewCard=null}))}}),N=D.actions,R=N.updateZoom,E=N.updatePosition,A=N.connectToRemoteGame,F=N.setPlayerColor,B=N.setPeerId,L=N.requestResync,G=N.setPreviewCardId,Q=N.clearPreviewCard,H=N.setMenuPreviewCardJsonId,W=N.clearMenuPreviewCardJsonId,U=N.updateActiveGameType,V=N.quitGame,K=D.reducer,J=function(e){var t,o,a;return{code:e.code,name:e.name,images:null,octgnId:null!==(t=e.octgn_id)&&void 0!==t?t:null,quantity:e.quantity,doubleSided:!!e.double_sided,backLink:null!==(o=e.back_link)&&void 0!==o?o:null,typeCode:e.type_code,subTypeCode:null,extraInfo:{setCode:null!==(a=e.set_code)&&void 0!==a?a:null,packCode:e.pack_code,factionCode:e.faction_code}}},z=function(e){return function(t){var o,a,n,r,s,i=null===(o=t.Back)||void 0===o?void 0:o.ImagePath;if(t.Back&&!t.Back.ImagePath){var d=t.Front.ImagePath,c=d.split(".").slice(0,-1).join(".");"A"!==c[c.length-1]?console.log("No Non-B Back Image Path for ".concat(t.Slug," from ").concat(t.CardSet)):i=d.replaceAll("A.","B.")}return{code:e?t.Slug:t.RingsDbCardId,name:t.Title,images:{front:t.Front.ImagePath,back:null!==(a=i)&&void 0!==a?a:null},octgnId:null!==(n=t.OctgnGuid)&&void 0!==n?n:null,quantity:null!==(r=t.Quantity)&&void 0!==r?r:1,doubleSided:!!t.Back,backLink:null,typeCode:t.CardType,subTypeCode:t.CardSubType,extraInfo:{setCode:null!==(s=t.CardSet)&&void 0!==s?s:null,packCode:"TODO - lotr",factionCode:e?"encounter":"player"}}}},q=function(e,t){return function(o){var a=e?o.location.entities:o.location.encounterEntities;"0"===o.card.code[0]&&"0"===o.card.code[1]||(a[o.card.code]&&t&&console.error("Found multiple cards with code "+o.card.code+" "+o.card.name+" "+o.card.extraInfo.setCode+" Existing card is "+a[o.card.code].name+" "+a[o.card.code].extraInfo.setCode),a[o.card.code]=o.card)}},Z=Object(h.d)({name:"cardsData",initialState:S,reducers:{loadCardsData:function(e){e.data={};var t=e.data[c.MarvelChampions];return t?t.setData={}:(e.data[c.MarvelChampions]={entities:{},encounterEntities:{},setData:{}},t=e.data[c.MarvelChampions]),j.forEach((function(e){t&&(t.setData[e.code]={name:e.name,setTypeCode:e.card_set_type_code,cardsInSet:[]})})),(t=e.data[c.LordOfTheRingsLivingCardGame])?t.setData={}:(e.data[c.LordOfTheRingsLivingCardGame]={entities:{},encounterEntities:{},setData:{}},t=e.data[c.LordOfTheRingsLivingCardGame]),k.forEach((function(e){t&&(t.setData[e.Slug]={name:e.Title,setTypeCode:e.Product,cardsInSet:[]})})),e},loadCardsDataForPack:function(e,t){if(e.data[t.payload.packType]||(e.data[t.payload.packType]={entities:{},encounterEntities:{},setData:{}}),t.payload.packType===c.MarvelChampions){var o=!t.payload.pack_code.includes("_encounter");t.payload.pack.map(J).map((function(o){return{location:e.data[t.payload.packType],card:o}})).forEach(q(o,!0))}else if(t.payload.packType===c.LordOfTheRingsLivingCardGame){var a=t.payload.pack;a.cards||console.log(a),a.cards.map(z(!1)).map((function(o){return{location:e.data[t.payload.packType],card:o}})).forEach(q(!0,!0))}return e},loadCardsForEncounterSet:function(e,t){var o=e.data[c.LordOfTheRingsLivingCardGame],a=null===o||void 0===o?void 0:o.setData[t.payload.setCode];if(t.payload.cards.map)return t.payload.cards.map(z(!0)).map((function(t){return{location:e.data[c.LordOfTheRingsLivingCardGame],card:t}})).forEach(q(!1,!1)),a&&(a.cardsInSet=a.cardsInSet.concat(t.payload.cards.filter((function(e){return-1===e.CardSet.toLocaleLowerCase().indexOf("nightmare")})).map((function(e){return{code:e.Slug,quantity:e.Quantity}})))),e;console.log("No cards found for scenario "+t.payload.setCode)}},extraReducers:function(e){e.addCase(O,(function(e,t){var o;e.activeDataType=null!==(o=t.payload.game.activeGameType)&&void 0!==o?o:c.MarvelChampions})),e.addCase(U,(function(e,t){e.activeDataType=t.payload}))}}),Y=Z.actions,X=Y.loadCardsData,$=Y.loadCardsDataForPack,ee=Y.loadCardsForEncounterSet,te=Z.reducer,oe=Object(h.b)("addCardStackWithId"),ae=Object(h.b)("pullCardOutOfCardStackWithId"),ne=Object(h.b)("drawCardsOutOfCardStackWithIds"),re=Object(h.b)("startCardMoveWithSplitStackId"),se=Object(h.b)("replaceCardStack"),ie=Object(h.b)("setStackShuffling"),de=Object(h.b)("createDeckFromTextFileWithIds"),ce=o(151),le=209,ue=150,he=418,pe=300,ge=function(e,t){var o=e.x-t.x,a=e.y-t.y;return Math.sqrt(o*o+a*a)},me=function(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}},fe=o(36),Ce=o.n(fe),Te=o(47),ve=o(55),ye=o.n(ve),be=o(76),Se=function(e){var t;return null!==(t=e.data[e.activeDataType])&&void 0!==t?t:{entities:{},encounterEntities:{},setData:{}}},je=function(e){return e.cardsData},ke=Object(be.a)(je,(function(e){var t=Se(e);return Object(w.a)(Object(w.a)({},t.entities),t.encounterEntities)})),xe=Object(be.a)(je,(function(e){return Se(e).entities})),Oe=Object(be.a)(je,(function(e){var t=Se(e),o={};return Object.values(t.entities).forEach((function(e){"hero"===e.typeCode&&(o[e.name]=e)})),o})),we=Object(be.a)(je,(function(e){var t=Se(e),o={};return Object.values(t.entities).forEach((function(e){"hero"!==e.typeCode&&(o[e.name]=e)})),o})),Pe=Object(be.a)(je,(function(e){return Se(e).encounterEntities})),_e=Object(be.a)(je,(function(e){return Se(e).setData})),Ie=Object(be.a)(_e,Pe,(function(e,t){return Object.entries(e).map((function(e){var o=Object(y.a)(e,2),a=o[0],n=o[1];return{setCode:a,setData:n,cards:n.cardsInSet.map((function(e){return t[e.code]}))}}))})),Me=Object(be.a)(Pe,_e,(function(e,t){var o={};return Object.values(e).forEach((function(e){var t=e.extraInfo.setCode||"unknown";o[t]?o[t].push(e):o[t]=[e]})),Object.entries(o).map((function(e){var o=Object(y.a)(e,2),a=o[0],n=o[1];return{setCode:a,setData:t[a],cards:n}})).filter((function(e){return"nemesis"!==e.setData.setTypeCode&&"hero"!==e.setData.setTypeCode})).sort((function(e,t){return e.setData.name>t.setData.name?1:-1}))})),De=function(e){return e.liveState.present.cards},Ne=Object(be.a)(De,(function(e){return e.cards.reduce((function(e,t){return e[t.id]=t,e}),{})})),Re=function(e){return e.liveState.present.cards.panMode},Ee=Object(be.a)(De,(function(e){var t={};return Object.entries(e.dropTargetCards).forEach((function(e){var o=Object(y.a)(e,2),a=o[0],n=o[1];n&&(t[n.id]={ownerRef:a,card:n})})),t})),Ae={bkw:"07",cap:"04",drs:"08",hlk:"09",trors:"10",twc:"03"},Fe={doctor_strange:[{jsonId:"09032"},{jsonId:"09033"},{jsonId:"09034"},{jsonId:"09035"},{jsonId:"09036"}],ant:[{jsonId:"12001c"}],wsp:[{jsonId:"13001c"}]},Be={marvelchampions:{deckSite:"marvelcdb.com",decklistApi:"https://marvelcdb.com/api/public/decklist/",encounterUiName:"Encounter Set",backgroundImageLocation:"/images/table/background_marvelchampions.png",tokens:{stunned:{menuText:"Stun",menuRemoveText:"Remove Stun",imagePath:"/card-game-playground/images/standard/stunned.png"},confused:{menuText:"Confuse",menuRemoveText:"Remove Confuse",imagePath:"/card-game-playground/images/standard/confused.png"},tough:{menuText:"Tough",menuRemoveText:"Remove Tough",imagePath:"/card-game-playground/images/standard/tough.png"},damage:{menuText:"Set Damage",imagePath:"/card-game-playground/images/standard/damage.png"},threat:{menuText:"Set Threat",imagePath:"/card-game-playground/images/standard/threat.png"},generic:{menuText:"Set Generic Tokens",imagePath:"/card-game-playground/images/standard/generic_counter.png"}}},lotrlcg:{deckSite:"ringsdb.com",decklistApi:"https://ringsdb.com/api/public/decklist/",encounterUiName:"Scenario",backgroundImageLocation:"/images/table/background_lotrlcg.jpg",tokens:{stunned:{menuText:"Quest",menuRemoveText:"Remove From Quest",imagePath:"/card-game-playground/images/standard/quest.png"},confused:null,tough:null,damage:{menuText:"Set Damage",imagePath:"/card-game-playground/images/standard/damage_lotr.png"},threat:{menuText:"Set Progress",imagePath:"/card-game-playground/images/standard/progress.png"},generic:{menuText:"Set Resource Tokens",imagePath:"/card-game-playground/images/standard/resource.png"}}}},Le=Object(h.c)("decklist/fetchByIdStatus",function(){var e=Object(Te.a)(Ce.a.mark((function e(t,o){var a,n;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get("".concat(Be[t.gameType].decklistApi).concat(t.decklistId));case 2:a=e.sent,n=o.getState(),e.t0=t.gameType,e.next=e.t0===c.MarvelChampions?7:e.t0===c.LordOfTheRingsLivingCardGame?8:9;break;case 7:return e.abrupt("return",Ge(a,n,t));case 8:return e.abrupt("return",Qe(a,n,t));case 9:case"end":return e.stop()}}),e)})));return function(t,o){return e.apply(this,arguments)}}()),Ge=function(e,t,o){var a,n=xe(t)[e.data.investigator_code].extraInfo.setCode,r=Pe(t),s=[];Object.entries(r).filter((function(e){var t=Object(y.a)(e,2),o=(t[0],t[1]);return(o.extraInfo.setCode==="".concat(n)||o.extraInfo.setCode==="".concat(n,"_nemesis"))&&"obligation"===o.typeCode})).forEach((function(e){var t=Object(y.a)(e,2),o=t[0],a=t[1];s=s.concat(Array.from({length:a.quantity}).map((function(e){return o})))}));var i=Object.values(r).filter((function(e){return e.extraInfo.setCode==="".concat(n,"_nemesis")&&"obligation"!==e.typeCode})),d=[];i.forEach((function(e){d=d.concat(Array.from({length:e.quantity}).map((function(t){return e.code})))}));var c=null!==(a=Fe[null!==n&&void 0!==n?n:""])&&void 0!==a?a:[];return{position:o.position,heroId:Object(f.a)(),data:e.data,dataId:Object(f.a)(),extraHeroCards:c,relatedEncounterDeck:d,encounterDeckId:Object(f.a)(),relatedObligationDeck:s,obligationDeckId:Object(f.a)()}},Qe=function(e,t,o){var a=xe(t),n=[];Object.entries(e.data.heroes).forEach((function(e){var t=Object(y.a)(e,2),o=t[0],a=t[1],r=Array.from(Array(a).keys()).map((function(){return{jsonId:o}}));n=n.concat(r)}));var r={};return Object.entries(e.data.slots).forEach((function(e){var t=Object(y.a)(e,2),o=t[0],n=t[1],s=a[o];if(!s)throw new Error("Couldn't find card data for ".concat(o));"Hero"!==s.typeCode&&(r[o]=n)})),e.data.slots=r,{position:o.position,heroId:Object(f.a)(),data:e.data,dataId:Object(f.a)(),extraHeroCards:n,relatedEncounterDeck:[],encounterDeckId:Object(f.a)(),relatedObligationDeck:[],obligationDeckId:Object(f.a)()}},He=function(e){for(var t,o,a=JSON.parse(JSON.stringify(e)),n=a.length;0!==n;)o=Math.floor(Math.random()*n),t=a[n-=1],a[n]=a[o],a[o]=t;return a},We=null!==(_=null===(I=b("liveState"))||void 0===I?void 0:I.cards)&&void 0!==_?_:{};We.cards&&We.cards.forEach((function(e){e.controlledBy="",e.selected=!1,e.shuffling=!1}));var Ue,Ve,Ke=Object(w.a)(Object(w.a)({},{cards:[],ghostCards:[],dropTargetCards:{},attachTargetCards:{},panMode:!0}),We);!function(e){e.Stunned="stunned",e.Confused="confused",e.Tough="tough"}(Ue||(Ue={})),function(e){e.Damage="damage",e.Threat="threat",e.Generic="generic"}(Ve||(Ve={}));var Je,ze,qe,Ze=function(e,t){return e.cards.find((function(e){return e.id===t}))},Ye=function(e,t,o,a){var n=Ze(e,t);!n||""!==n.controlledBy&&n.controlledBy!==o||a(n)},Xe=function(e,t){e.cards.filter((function(e){return!e.selected})).forEach((function(e){return t(e)}))},$e=function(e,t){e.cards.filter((function(e){return""===e.controlledBy||e.controlledBy===t.ACTOR_REF})).forEach((function(e){e.selected=!1,e.controlledBy=""}))},et=Object(h.d)({name:"cards",initialState:Ke,reducers:{selectCard:function(e,t){t.payload.unselectOtherCards&&$e(e,t),Ye(e,t.payload.id,t.ACTOR_REF,(function(e){e.selected=!0,e.controlledBy=t.ACTOR_REF}))},unselectCard:function(e,t){Ye(e,t.payload,t.ACTOR_REF,(function(e){e.selected=!1,e.controlledBy=""}))},toggleSelectCard:function(e,t){Ye(e,t.payload,t.ACTOR_REF,(function(e){e.selected=!e.selected,e.selected?e.controlledBy=t.ACTOR_REF:e.controlledBy=""}))},exhaustCard:function(e,t){e.cards.filter((function(e){var o;return e.controlledBy===t.ACTOR_REF&&(e.id===(null!==(o=t.payload)&&void 0!==o?o:"")||e.selected)})).forEach((function(e){e.exhausted=!e.exhausted}))},cardMove:function(e,t){var o,a,n,r,s=[],i=null;e.cards.filter((function(e){return e.id===t.payload.id||e.selected&&e.controlledBy===t.ACTOR_REF})).forEach((function(e){e.id===t.payload.id&&(i=e),e.x+=t.payload.dx,e.y+=t.payload.dy,s.push(e)}));var d=[];i&&i.controlledBy===t.ACTOR_REF&&Xe(e,(function(e){var t=ge({x:e.x,y:e.y},i?{x:i.x,y:i.y}:{x:0,y:0});t<30&&d.push({distance:t,card:e})})),e.dropTargetCards[t.ACTOR_REF]=null!==(o=null===(a=d.sort((function(e,t){return e.distance-t.distance}))[0])||void 0===a?void 0:a.card)&&void 0!==o?o:null;var c=[];i&&i.controlledBy===t.ACTOR_REF&&Xe(e,(function(e){var t,o,a,n,r=ge(i?{x:i.x,y:i.y}:{x:0,y:0},{x:e.x,y:e.y});r<150&&r>50&&e.x<(null!==(t=null===(o=i)||void 0===o?void 0:o.x)&&void 0!==t?t:0)&&e.y>(null!==(a=null===(n=i)||void 0===n?void 0:n.y)&&void 0!==a?a:0)&&c.push({distance:r,card:e})})),e.attachTargetCards[t.ACTOR_REF]=null!==(n=null===(r=c.sort((function(e,t){return e.distance-t.distance}))[0])||void 0===r?void 0:r.card)&&void 0!==n?n:null;var l=e.attachTargetCards[t.ACTOR_REF];if(l){if(!e.ghostCards.find((function(e){return e.x===l.x+50&&e.y===l.y-50&&e.cardStack.length>0&&"-1"===e.cardStack[0].jsonId}))){var u=JSON.parse(JSON.stringify(l));u.id=Object(f.a)(),u.x+=50,u.y-=50,u.cardStack=[{jsonId:"-1"}],e.ghostCards.push(u)}}else e.ghostCards=e.ghostCards.filter((function(e){return e.cardStack.length>0&&"-1"!==e.cardStack[0].jsonId}));s.forEach((function(t){e.cards.push(e.cards.splice(e.cards.indexOf(t),1)[0])}))},endCardMove:function(e,t){var o=[],a=[];e.cards.filter((function(e){return e.id===t.payload||e.selected&&e.controlledBy===t.ACTOR_REF})).forEach((function(n){n.dragging=!1,e.attachTargetCards[t.ACTOR_REF]?a.push(n):e.dropTargetCards[t.ACTOR_REF]&&(o=o.concat(n.cardStack))}));var n=e.attachTargetCards[t.ACTOR_REF];if(n)a.forEach((function(t,o){t.x=n.x+50*(o+1),t.y=n.y-50*(o+1),e.cards.unshift(e.cards.splice(e.cards.indexOf(t),1)[0])}));else if(e.dropTargetCards[t.ACTOR_REF]){e.cards=e.cards.filter((function(e){return!(e.id===t.payload||e.selected&&e.controlledBy===t.ACTOR_REF)}));var r=e.cards.find((function(o){var a;return o.id===(null===(a=e.dropTargetCards[t.ACTOR_REF])||void 0===a?void 0:a.id)}));r&&o.length>0&&(r.cardStack=o.concat(r.cardStack))}e.ghostCards=[],e.dropTargetCards[t.ACTOR_REF]=null,e.attachTargetCards[t.ACTOR_REF]=null},selectMultipleCards:function(e,t){t.payload.ids.map((function(t){return e.cards.find((function(e){return e.id===t}))})).forEach((function(e){!e||""!==e.controlledBy&&e.controlledBy!==t.ACTOR_REF||(e.selected=!0,e.controlledBy=t.ACTOR_REF)}))},unselectAllCards:$e,togglePanMode:function(e){e.panMode=!e.panMode},flipCards:function(e,t){e.cards.filter((function(e){return e.selected&&(""===e.controlledBy||e.controlledBy===t.ACTOR_REF)})).forEach((function(e){e.faceup=!e.faceup,e.cardStack=e.cardStack.reverse()}))},resetCards:function(e){e.cards=[]},toggleToken:function(e,t){var o=e.cards.find((function(e){return e.id===t.payload.id}));o&&(o.statusTokens[t.payload.tokenType]=t.payload.value)},adjustCounterToken:function(e,t){e.cards.filter((function(e){return!!t.payload.id&&t.payload.id===e.id||e.selected&&e.controlledBy===t.ACTOR_REF})).forEach((function(e){void 0!==t.payload.value?e.counterTokens[t.payload.tokenType]=t.payload.value:void 0!==t.payload.delta&&(e.counterTokens[t.payload.tokenType]+=t.payload.delta),e.counterTokens[t.payload.tokenType]<0&&(e.counterTokens[t.payload.tokenType]=0)}))}},extraReducers:function(e){e.addCase(O,(function(e,t){e.cards=t.payload.liveState.present.cards.cards,e.ghostCards=t.payload.liveState.present.cards.ghostCards})),e.addCase(se,(function(e,t){var o=e.cards.find((function(e){return e.id===t.payload.id}));o&&(o.cardStack=t.payload.newStack)})),e.addCase(x,(function(e){e.cards=[],e.dropTargetCards={},e.ghostCards=[],e.panMode=!0})),e.addCase(oe,(function(e,t){var o={controlledBy:"",x:t.payload.position.x,y:t.payload.position.y,dragging:!1,shuffling:!1,exhausted:!1,faceup:!0,fill:"red",id:t.payload.id,cardStack:t.payload.cardJsonIds.map((function(e){return{jsonId:e}})),selected:!1,statusTokens:{stunned:!1,confused:!1,tough:!1},counterTokens:{damage:0,threat:0,generic:0}};e.cards.push(o)})),e.addCase(ae,(function(e,t){var o=e.cards.find((function(e){return e.id===t.payload.cardStackId}));if(o&&o.cardStack.length>1){var a=[{jsonId:t.payload.jsonId}],n=Object.assign({},o,{cardStack:a});n.id=t.payload.id,n.selected=!0,n.controlledBy=t.ACTOR_REF,n.x=n.x+ue+5;var r=o.cardStack.findIndex((function(e){return e.jsonId===t.payload.jsonId}));-1!==r&&o.cardStack.splice(r,1),o.selected=!1,o.controlledBy="",e.cards.push(n)}})),e.addCase(re,(function(e,t){var o=Ze(e,t.payload.id);if(o&&!o.selected&&(e.cards=e.cards.map((function(e){return""!==e.controlledBy&&e.controlledBy!==t.ACTOR_REF||(e.selected=e.id===t.payload.id,e.selected?e.controlledBy=t.ACTOR_REF:e.controlledBy=""),e}))),t.payload.splitTopCard){var a=e.cards.find((function(e){return e.id===t.payload.id}));if(!a)throw new Error("Expected to find card");a.selected=!1,a.controlledBy="";var n=a.cardStack.shift(),r=Object.assign({},a,{selected:!0,controlledBy:t.ACTOR_REF,dragging:!0,cardStack:[n]});a.id=t.payload.splitCardId,e.cards.push(r)}e.ghostCards=[],t.payload.splitTopCard||function(e,t,o){e.cards.filter((function(e){return e.selected&&e.controlledBy===t})).forEach((function(e){return o(e)}))}(e,t.ACTOR_REF,(function(t){t.dragging=!0,e.ghostCards.push(Object.assign({},t))}))})),e.addCase(ne,(function(e,t){if(t.payload.numberToDraw!==t.payload.idsToUse.length)throw new Error("Did not receive the expected number of ids");$e(e,t);var o=e.cards.find((function(e){return e.id===t.payload.cardStackId}));if(!o)throw new Error("Couldn't find card stack with id ".concat(t.payload.cardStackId));for(var a=o.id,n=0;n<t.payload.numberToDraw;n++)if(o){var r=o.cardStack.shift();if(!r)throw new Error("Expected to find a top card, but didn't");var s=[{jsonId:r.jsonId}],i=Object.assign({},o,{cardStack:s});i.id=t.payload.idsToUse[n],i.selected=!0,i.controlledBy=t.ACTOR_REF,i.faceup=!0,i.x=i.x+(ue+5)*(n+1),i.y+=le,0===o.cardStack.length&&(e.cards=e.cards.filter((function(e){return e.id!==a})),o=void 0),e.cards.push(i)}})),e.addCase(ie,(function(e,t){var o=e.cards.find((function(e){return e.id===t.payload.id}));o&&(o.shuffling=t.payload.shuffling)})),e.addCase(de,(function(e,t){return tt(e,t)})),e.addCase(Le.fulfilled,(function(e,t){return tt(e,t)}))}}),tt=function(e,t){console.log("got decklist"),console.log(t);var o=t.payload.data.investigator_code?[{jsonId:t.payload.data.investigator_code}]:[],a=[].concat(o,Object(ce.a)(t.payload.extraHeroCards)),n={controlledBy:t.ACTOR_REF,selected:!0,x:t.payload.position.x,y:t.payload.position.y,dragging:!1,shuffling:!1,exhausted:!1,faceup:!0,fill:"red",id:t.payload.heroId,cardStack:a,statusTokens:{stunned:!1,confused:!1,tough:!1},counterTokens:{damage:0,threat:0,generic:0}},r=[];Object.entries(t.payload.data.slots).forEach((function(e){var t=Object(y.a)(e,2),o=t[0],a=t[1],n=Array.from(Array(a).keys()).map((function(){return{jsonId:o}}));r=r.concat(n)}));var s=ue+10,i={controlledBy:t.ACTOR_REF,selected:!0,x:t.payload.position.x+s,y:t.payload.position.y,dragging:!1,shuffling:!1,exhausted:!1,faceup:!0,fill:"red",id:t.payload.dataId,cardStack:r,statusTokens:{stunned:!1,confused:!1,tough:!1},counterTokens:{damage:0,threat:0,generic:0}},d={controlledBy:t.ACTOR_REF,selected:!0,x:t.payload.position.x+2*s,y:t.payload.position.y,dragging:!1,shuffling:!1,exhausted:!1,faceup:!0,fill:"red",id:t.payload.encounterDeckId,cardStack:t.payload.relatedEncounterDeck.map((function(e){return{jsonId:e}})),statusTokens:{stunned:!1,confused:!1,tough:!1},counterTokens:{damage:0,threat:0,generic:0}},c={controlledBy:t.ACTOR_REF,selected:!0,x:t.payload.position.x+3*s,y:t.payload.position.y,dragging:!1,shuffling:!1,exhausted:!1,faceup:!0,fill:"red",id:t.payload.obligationDeckId,cardStack:t.payload.relatedObligationDeck.map((function(e){return{jsonId:e}})),statusTokens:{stunned:!1,confused:!1,tough:!1},counterTokens:{damage:0,threat:0,generic:0}};n.cardStack.length>0&&e.cards.push(n),i.cardStack.length>0&&e.cards.push(i),d.cardStack.length>0&&e.cards.push(d),c.cardStack.length>0&&e.cards.push(c)},ot=et.actions,at=ot.selectCard,nt=ot.unselectCard,rt=ot.toggleSelectCard,st=ot.exhaustCard,it=ot.cardMove,dt=ot.endCardMove,ct=ot.selectMultipleCards,lt=ot.unselectAllCards,ut=ot.togglePanMode,ht=ot.flipCards,pt=(ot.resetCards,ot.toggleToken),gt=ot.adjustCounterToken,mt=et.reducer,ft=Object(h.b)("addNewCounterWithId"),Ct=null!==(Je=null===(ze=b("liveState"))||void 0===ze?void 0:ze.counters)&&void 0!==Je?Je:{},Tt=Object(w.a)(Object(w.a)({},{counters:[],firstPlayerCounterPosition:{x:0,y:0}}),Ct),vt=Object(h.d)({name:"counters",initialState:Tt,reducers:{updateCounterValue:function(e,t){var o=e.counters.find((function(e){return e.id===t.payload.id}));o&&(o.value+=t.payload.delta,o.value<0&&(o.value=0))},removeCounter:function(e,t){e.counters=e.counters.filter((function(e){return e.id!==t.payload}))},moveCounter:function(e,t){var o=e.counters.find((function(e){return e.id===t.payload.id}));o&&(o.position={x:t.payload.newPos.x,y:t.payload.newPos.y})},moveFirstPlayerCounter:function(e,t){e.firstPlayerCounterPosition={x:t.payload.x,y:t.payload.y}},updateCounterColor:function(e,t){var o=e.counters.find((function(e){return e.id===t.payload.id}));o&&(o.color=t.payload.newColor)}},extraReducers:function(e){e.addCase(O,(function(e,t){e.counters=t.payload.liveState.present.counters.counters,e.firstPlayerCounterPosition=t.payload.liveState.present.counters.firstPlayerCounterPosition})),e.addCase(x,(function(e,t){e.counters=[],e.firstPlayerCounterPosition={x:0,y:0}})),e.addCase(ft,(function(e,t){e.counters.push({id:t.payload.id,position:t.payload.pos,value:0,color:"red"})}))}}),yt=vt.actions,bt=yt.updateCounterValue,St=yt.removeCounter,jt=yt.moveCounter,kt=yt.moveFirstPlayerCounter,xt=yt.updateCounterColor,Ot=vt.reducer,wt=Object(p.c)({counters:Ot,cards:mt}),Pt=Object(p.c)({game:K,cardsData:te,liveState:m()(wt,{limit:20,groupBy:Object(g.groupByActionTypes)([jt.type]),filter:Object(g.excludeAction)([re.type,it.type,G.type,Q.type])})}),_t=o(28),It=o(141),Mt=o.n(It),Dt=(qe={},Object(_t.a)(qe,A.type,!0),Object(_t.a)(qe,E.type,!0),Object(_t.a)(qe,R.type,!0),Object(_t.a)(qe,G.type,!0),Object(_t.a)(qe,Q.type,!0),Object(_t.a)(qe,H.type,!0),Object(_t.a)(qe,W.type,!0),Object(_t.a)(qe,ut.type,!0),Object(_t.a)(qe,O.type,!0),Object(_t.a)(qe,L.type,!0),Object(_t.a)(qe,X.type,!0),Object(_t.a)(qe,$.type,!0),Object(_t.a)(qe,ee.type,!0),qe),Nt=function(){false},Rt=function(e,t){e.on("data",(function(o){o.INITIAL_STATE_MSG?(console.log("going to replace (most of) state with",o.state),setTimeout((function(){t.dispatch(O(o.state))}),0)):o.RESYNC?(Nt("received request for resync"),e.send({INITIAL_STATE_MSG:!0,state:t.getState()})):(Nt("recieved remote action",o),o.REMOTE_ACTION=!0,Nt("dispatching remote action",o),t.dispatch(o))}))},Et=Object(h.e)({thunk:!0,immutableCheck:!1,serializableCheck:!1}).concat((function(e){var t,o=new Mt.a(void 0,{debug:0,config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",username:"webrtc@live.com",credential:"muazkh"}]}});return o.on("error",(function(e){console.error("*****************Server error"),console.error(e)})),o.on("disconnected",(function(){console.log("****Peer server connection disconnected")})),o.on("open",(function(a){console.log("My peer ID is: "+a),e.dispatch(B(a));var n=window.location.href.split("remote=");if(n.length>1){var r=n[1].split("&")[0];console.log("FOUND QUERY PARAM. Going to connect to peer "+r),t=o.connect(r,{metadata:{ref:C}}),Rt(t,e)}})),o.on("connection",(function(o){console.log("Connection received!"),Rt(t=o,e),t.on("open",(function(){console.log("connection ready for data"),Nt("going to send initial state",e.getState()),t.send({INITIAL_STATE_MSG:!0,state:e.getState()});var o=F({ref:t.metadata.ref,color:"blue"});t.send(o),t.send(F({ref:C,color:"red"})),e.dispatch(o)})),t.on("error",(function(e){console.error("****************Connection error:",e)})),t.on("close",(function(){console.log("******connection closed for ref "+t.metadata.ref)})),t.peerConnection.onconnectionstatechange=function(e){console.log("connection state changed"),console.log(e),console.log(t.peerConnection.connectionState),"closed"!==t.peerConnection.connectionState&&"disconnected"!==t.peerConnection.connectionState||console.log("CLEARING CLIENT OWNED CARDS for "+t.metadata.ref)}})),function(a){return function(n){return Nt("received local action",n),n.REMOTE_ACTION?n.ACTOR_REF||(console.error("Received a REMOTE action without an ACTOR_REF:"),console.log(n)):n.ACTOR_REF=C,n.type===A.type?(console.log("going to connect to peer "+n.payload),t=o.connect(n.payload,{metadata:{ref:C}}),Rt(t,e)):n.type===L.type&&t&&t.send({RESYNC:!0}),n.REMOTE_ACTION||!t||Dt[n.type]||(Nt("going to send action to peer!"),t.send(n)),a(n)}}}));var At=o(19),Ft=o(18),Bt=o(21),Lt=o(20),Gt=o(142),Qt=o(80),Ht=o.n(Qt),Wt=o(22),Ut=o(65),Vt=47,Kt=47,Jt=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(e){var a,n,r,s;Object(At.a)(this,o),(s=t.call(this,e)).damageImg=void 0,s.threatImg=void 0,s.genericImg=void 0,s.unmounted=void 0,s.unmounted=!0,s.state={imagesLoaded:{damage:!1,threat:!1,generic:!1}},s.damageImg=new Image,s.threatImg=new Image,s.genericImg=new Image;var i=Be[s.props.currentGameType].tokens;return s.damageImg.onload=function(){s.unmounted||s.setState({imagesLoaded:{damage:!0,threat:s.state.imagesLoaded.threat,generic:s.state.imagesLoaded.generic}})},(null===(a=s.props.card)||void 0===a?void 0:a.counterTokens.damage)&&i.damage&&(s.damageImg.src=i.damage.imagePath),s.threatImg.onload=function(){s.unmounted||s.setState({imagesLoaded:{damage:s.state.imagesLoaded.damage,threat:!0,generic:s.state.imagesLoaded.generic}})},(null===(n=s.props.card)||void 0===n?void 0:n.counterTokens.threat)&&i.threat&&(s.threatImg.src=i.threat.imagePath),s.genericImg.onload=function(){s.unmounted||s.setState({imagesLoaded:{damage:s.state.imagesLoaded.damage,threat:s.state.imagesLoaded.threat,generic:!0}})},(null===(r=s.props.card)||void 0===r?void 0:r.counterTokens.generic)&&i.generic&&(s.genericImg.src=i.generic.imagePath),s}return Object(Ft.a)(o,[{key:"componentDidUpdate",value:function(e,t){var o,a,n,r,s,i,d=Be[this.props.currentGameType].tokens;!this.state.imagesLoaded.damage&&!(null===(o=e.card)||void 0===o?void 0:o.counterTokens.damage)&&(null===(a=this.props.card)||void 0===a?void 0:a.counterTokens.damage)&&d.damage&&(this.damageImg.src=d.damage.imagePath),!this.state.imagesLoaded.threat&&!(null===(n=e.card)||void 0===n?void 0:n.counterTokens.threat)&&(null===(r=this.props.card)||void 0===r?void 0:r.counterTokens.threat)&&d.threat&&(this.threatImg.src=d.threat.imagePath),!this.state.imagesLoaded.generic&&!(null===(s=e.card)||void 0===s?void 0:s.counterTokens.generic)&&(null===(i=this.props.card)||void 0===i?void 0:i.counterTokens.generic)&&d.generic&&(this.genericImg.src=d.generic.imagePath)}},{key:"componentDidMount",value:function(){this.unmounted=!1}},{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"render",value:function(){if(!this.props.card)return null;var e=this.props.x-23.5,t=this.props.y-le/2+20,o=this.state.imagesLoaded.damage&&!!this.props.card.counterTokens.damage,n=o?Object(a.jsx)(Wt.c,{x:e,y:t,scale:{x:Vt/this.damageImg.naturalWidth,y:Kt/this.damageImg.naturalHeight},width:this.damageImg.naturalWidth,height:this.damageImg.naturalHeight,fillPatternImage:this.damageImg},"".concat(this.props.card.id,"-damageToken")):null,r=o?Object(a.jsx)(Wt.e,{x:e,y:t,width:this.damageImg.naturalWidth*(Vt/this.damageImg.naturalWidth),height:this.damageImg.naturalHeight*(Kt/this.damageImg.naturalHeight),text:"".concat(this.props.card.counterTokens.damage),fill:"white",align:"center",verticalAlign:"middle",fontSize:24},"".concat(this.props.card.id,"-damageText")):null,s=this.props.x-23.5,i=t+Kt+5,d=this.state.imagesLoaded.threat&&!!this.props.card.counterTokens.threat,c=d?Object(a.jsx)(Wt.c,{x:s,y:i,scale:{x:Vt/this.threatImg.naturalWidth,y:Kt/this.threatImg.naturalHeight},width:this.threatImg.naturalWidth,height:this.threatImg.naturalHeight,fillPatternImage:this.threatImg},"".concat(this.props.card.id,"-threatToken")):null,l=d?Object(a.jsx)(Wt.e,{x:s,y:i,width:this.threatImg.naturalWidth*(Vt/this.threatImg.naturalWidth),height:this.threatImg.naturalHeight*(Kt/this.threatImg.naturalHeight),text:"".concat(this.props.card.counterTokens.threat),fill:"white",align:"center",verticalAlign:"middle",fontSize:24},"".concat(this.props.card.id,"-threatText")):null,u=this.props.x-23.5,h=i+Kt+5,p=this.state.imagesLoaded.generic&&!!this.props.card.counterTokens.generic;return[n,r,c,l,p?Object(a.jsx)(Wt.c,{x:u,y:h,scale:{x:Vt/this.genericImg.naturalWidth,y:Kt/this.genericImg.naturalHeight},width:this.genericImg.naturalWidth,height:this.genericImg.naturalHeight,fillPatternImage:this.genericImg},"".concat(this.props.card.id,"-genericToken")):null,p?Object(a.jsx)(Wt.e,{x:u,y:h,width:this.genericImg.naturalWidth*(Vt/this.genericImg.naturalWidth),height:this.genericImg.naturalHeight*(Kt/this.genericImg.naturalHeight),text:"".concat(this.props.card.counterTokens.generic),fill:"white",align:"center",verticalAlign:"middle",fontSize:24},"".concat(this.props.card.id,"-genericText")):null]}}]),o}(n.Component),zt=Object(d.c)((function(e,t){return{card:Ne(e)[t.id]}}),{})(Jt),qt=["main_scheme","side_scheme","quest","player_side_quest"],Zt=function(e,t){return e.length===t.length&&e.every((function(e,o){return e===t[o]}))},Yt=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(e){var n,r,s,i;Object(At.a)(this,o),(i=t.call(this,e)).imgs=[],i.stunnedImg=void 0,i.confusedImg=void 0,i.toughImg=void 0,i.unmounted=void 0,i.touchTimer=null,i.rect=null,i.shuffleToggle=!1,i.initCardImages=function(e){i.imgs=e.imgUrls.map((function(){return new Image})),i.imgs.forEach((function(e){return e.onload=function(){i.unmounted||i.setState({imageLoaded:!0})}})),i.imgs.forEach((function(e){return e.onerror=function(){i.unmounted||i.setState({imageLoadFailed:i.state.imageLoadFailed+1})}})),e.imgUrls.forEach((function(e,t){return i.imgs[t].src=e}))},i.getStrokeColor=function(){return i.props.dropTargetColor?i.props.dropTargetColor:i.props.selected?i.props.selectedColor:""},i.renderUnanimatedCard=function(e,t,o){var n,r,s,d=o?i.imgs.find((function(e){return e.complete&&0!==e.naturalHeight})):void 0,c=i.getScale(d,t,e),l={x:t/2,y:e/2},u=Object(a.jsx)(Ut.Spring,{native:!0,to:{rotation:i.props.exhausted?90:0},children:function(n){return Object(a.jsx)(Ut.animated.Rect,Object(w.a)(Object(w.a)({},n),{},{ref:function(e){e&&(i.rect=e)},cornerRadius:9,x:i.props.x,y:i.props.y,width:t,height:e,offset:l,stroke:i.getStrokeColor(),strokeWidth:i.getStrokeColor()?4:0,fillPatternRotation:!o||i.shouldRenderImageHorizontal(i.props.typeCode||"",qt)?270:0,fillPatternImage:d,fillPatternScaleX:c.width,fillPatternScaleY:c.height,fill:o?void 0:"gray",shadowForStrokeEnabled:!1,hitStrokeWidth:0,opacity:i.props.isGhost?.5:1,draggable:""===i.props.controlledBy||i.props.controlledBy===C,onDragStart:i.handleDragStart,onDragMove:i.handleDragMove,onDragEnd:i.handleDragEnd,onDblClick:i.handleDoubleClick,onDblTap:i.handleDoubleTap,onClick:i.handleClick,onTap:i.handleClick,onMouseDown:i.handleMouseDown,onTouchStart:i.handleTouchStart,onTouchMove:i.handleTouchMove,onTouchEnd:i.handleTouchEnd,onMouseOver:i.handleMouseOver,onMouseOut:i.handleMouseOut,onContextMenu:i.handleContextMenu}))}},"".concat(i.props.id,"-card")),h={x:l.x+4,y:l.y-4},p=(i.props.numCardsInStack||1)>1?Object(a.jsx)(Ut.Spring,{native:!0,to:{rotation:i.props.exhausted?90:0},children:function(o){return Object(a.jsx)(Ut.animated.Rect,Object(w.a)(Object(w.a)({},o),{},{cornerRadius:[9,9,9,9],x:i.props.x,y:i.props.y,width:t,height:e,offset:h,opacity:i.props.isGhost?.5:1,fill:"gray",shadowForStrokeEnabled:!1,hitStrokeWidth:0}))}},"".concat(i.props.id,"-cardStack")):null,g=!!(null===(n=i.props.cardState)||void 0===n?void 0:n.stunned)&&i.state.tokenImagesLoaded.stunned,m=i.getTokenInSlot(g,i.stunnedImg,l,0),f=i.getTokenInSlot(!!(null===(r=i.props.cardState)||void 0===r?void 0:r.confused)&&i.state.tokenImagesLoaded.confused,i.confusedImg,l,1),T=i.getTokenInSlot(!!(null===(s=i.props.cardState)||void 0===s?void 0:s.tough)&&i.state.tokenImagesLoaded.tough,i.toughImg,l,2),v=i.props.dragging||i.props.isGhost?null:Object(a.jsx)(zt,{currentGameType:i.props.currentGameType,id:i.props.id,x:i.props.x,y:i.props.y},"".concat(i.props.id,"-cardTokens"));return[p,u,i.renderCardName(l,t,e),m,f,T,v]},i.handleContextMenu=function(e){i.props.handleContextMenu&&i.props.handleContextMenu(i.props.id,e)},i.handleDoubleClick=function(e){i.props.handleDoubleClick&&i.props.handleDoubleClick(i.props.id,e)},i.handleDoubleTap=function(e){i.props.handleDoubleTap&&i.props.handleDoubleTap(i.props.id,e)},i.handleDragStart=function(e){i.props.handleDragStart&&i.props.handleDragStart(i.props.id,e)},i.handleDragMove=function(e){i.props.handleDragMove&&i.props.handleDragMove({id:i.props.id,dx:e.target.x()-i.props.x,dy:e.target.y()-i.props.y})},i.handleDragEnd=function(){i.props.handleDragEnd&&i.props.dragging&&i.props.handleDragEnd(i.props.id)},i.handleClick=function(e){i.props.handleClick&&(i.props.handleClick(i.props.id,e),e.cancelBubble=!0)},i.handleMouseDown=function(e){e.cancelBubble=!0},i.handleTouchStart=function(e){e.cancelBubble=!0,i.touchTimer&&(clearTimeout(i.touchTimer),i.touchTimer=null),i.touchTimer=setTimeout((function(){i.handleContextMenu(e)}),750)},i.handleTouchMove=function(e){i.touchTimer&&(clearTimeout(i.touchTimer),i.touchTimer=null)},i.handleTouchEnd=function(e){i.touchTimer&&(clearTimeout(i.touchTimer),i.touchTimer=null)},i.handleMouseOver=function(){i.props.handleHover&&i.props.handleHover(i.props.id)},i.handleMouseOut=function(){i.props.handleHoverLeave&&i.props.handleHoverLeave(i.props.id)},i.unmounted=!0,i.state={imageLoaded:!1,imageLoadFailed:0,prevImgUrls:i.props.imgUrls,tokenImagesLoaded:{stunned:!1,confused:!1,tough:!1}},i.initCardImages(e),i.stunnedImg=new Image,i.confusedImg=new Image,i.toughImg=new Image,i.stunnedImg.onload=function(){i.unmounted||i.setState({tokenImagesLoaded:{stunned:!0,confused:i.state.tokenImagesLoaded.confused,tough:i.state.tokenImagesLoaded.tough}})};var d=Be[e.currentGameType].tokens;return(null===(n=e.cardState)||void 0===n?void 0:n.stunned)&&d.stunned&&(i.stunnedImg.src=d.stunned.imagePath),i.confusedImg.onload=function(){i.unmounted||i.setState({tokenImagesLoaded:{stunned:i.state.tokenImagesLoaded.stunned,confused:!0,tough:i.state.tokenImagesLoaded.tough}})},(null===(r=e.cardState)||void 0===r?void 0:r.confused)&&d.confused&&(i.confusedImg.src=d.confused.imagePath),i.toughImg.onload=function(){i.unmounted||i.setState({tokenImagesLoaded:{stunned:i.state.tokenImagesLoaded.stunned,confused:i.state.tokenImagesLoaded.confused,tough:!0}})},(null===(s=e.cardState)||void 0===s?void 0:s.tough)&&d.tough&&(i.toughImg.src=d.tough.imagePath),i}return Object(Ft.a)(o,null,[{key:"getDerivedStateFromProps",value:function(e,t){var o;return Zt(e.imgUrls,null!==(o=t.prevImgUrls)&&void 0!==o?o:[])?null:{imageLoaded:!1,imageLoadFailed:0,prevImgUrls:e.imgUrls,tokenImagesLoaded:{stunned:t.tokenImagesLoaded.stunned,confused:t.tokenImagesLoaded.confused,tough:t.tokenImagesLoaded.tough}}}}]),Object(Ft.a)(o,[{key:"componentDidUpdate",value:function(e,t){var o,a,n,r,s,i;!e.shuffling&&this.props.shuffling&&this.rect&&(this.shuffleToggle=!this.shuffleToggle,this.rect.to({rotation:this.currentRotation+(this.shuffleToggle?360:-360),duration:.2})),this.state.imageLoaded||Zt(e.imgUrls,this.props.imgUrls)||(this.setState({imageLoaded:!1,imageLoadFailed:0}),this.initCardImages(this.props));var d=Be[this.props.currentGameType].tokens;!this.state.tokenImagesLoaded.stunned&&!(null===(o=e.cardState)||void 0===o?void 0:o.stunned)&&(null===(a=this.props.cardState)||void 0===a?void 0:a.stunned)&&d.stunned&&(this.stunnedImg.src=d.stunned.imagePath),!this.state.tokenImagesLoaded.confused&&!(null===(n=e.cardState)||void 0===n?void 0:n.confused)&&(null===(r=this.props.cardState)||void 0===r?void 0:r.confused)&&d.confused&&(this.confusedImg.src=d.confused.imagePath),!this.state.tokenImagesLoaded.tough&&!(null===(s=e.cardState)||void 0===s?void 0:s.tough)&&(null===(i=this.props.cardState)||void 0===i?void 0:i.tough)&&d.tough&&(this.toughImg.src=d.tough.imagePath)}},{key:"componentDidMount",value:function(){this.unmounted=!1}},{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"render",value:function(){return this.renderCard(this.state.imageLoaded)}},{key:"renderCard",value:function(e){var t=this.props.height||le,o=this.props.width||ue;return this.renderUnanimatedCard(t,o,e)}},{key:"renderCardName",value:function(e,t,o){var n={x:e.x-10,y:e.y-20};return this.state.imageLoadFailed===this.props.imgUrls.length&&0!==this.state.imageLoadFailed?Object(a.jsx)(Wt.e,{offset:n,x:this.props.x,y:this.props.y,width:t-10,height:o-20,fontSize:24,text:"".concat(this.props.name," ").concat(this.props.code),draggable:""===this.props.controlledBy||this.props.controlledBy===C,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd,onDblClick:this.handleDoubleClick,onDblTap:this.handleDoubleClick,onClick:this.handleClick,onTap:this.handleClick,onMouseDown:this.handleMouseDown,onTouchStart:this.handleMouseDown,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onContextMenu:this.handleContextMenu},"".concat(this.props.id,"-cardnametext")):null}},{key:"getTokenInSlot",value:function(e,t,o,n){var r={width:t.naturalWidth/2,height:t.naturalHeight/2},s={x:o.x-ue+r.width/2,y:o.y-r.height*n-5*(n+1)-10};return e?Object(a.jsx)(Wt.c,{native:!0,cornerRadius:8,x:this.props.x,y:this.props.y,width:r.width,height:r.height,fillPatternScaleX:.5,fillPatternScaleY:.5,offset:s,fillPatternImage:t},"".concat(this.props.id,"-status").concat(n)):null}},{key:"shouldRenderImageHorizontal",value:function(e,t){return t.includes(e.toLocaleLowerCase())&&!this.plainCardBack}},{key:"getScale",value:function(e,t,o){var a=e?t/e.naturalWidth:t,n=e?o/e.naturalWidth:t,r=e?o/e.naturalHeight:o,s=e?t/e.naturalHeight:o;return this.shouldRenderImageHorizontal(this.props.typeCode||"",qt)?{width:n,height:s}:{width:a,height:r}}},{key:"plainCardBack",get:function(){return this.props.imgUrls.some((function(e){return e.includes("standard")}))&&this.props.imgUrls.some((function(e){return e.includes("_back")}))}},{key:"currentRotation",get:function(){return this.props.exhausted?90:0}}]),o}(n.Component),Xt=o(320),$t=o(326),eo=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(e){var a;return Object(At.a)(this,o),(a=t.call(this,e)).cardsDataInStack=[],a.handleHighlightChange=function(e,t,o){t?a.props.preview(t.code):a.props.clearPreview()},a.handleSelected=function(e,t){a.props.clearPreview(),t&&a.props.cardSelected&&a.props.cardSelected(t.code)},a.cancelBubble=function(e){e.stopPropagation()},a.cardsDataInStack=e.card.cardStack.map((function(e){return a.props.cardsDataEntities[e.jsonId]})),a}return Object(Ft.a)(o,[{key:"componentWillUnmount",value:function(){this.props.clearPreview()}},{key:"render",value:function(){return Object(a.jsx)("div",{onClick:this.cancelBubble,onKeyPress:this.cancelBubble,children:Object(a.jsx)(Xt.a,{id:"cardstack-card-selector-combobox",options:this.cardsDataInStack,getOptionLabel:function(e){return e.name},style:{width:300},onChange:this.handleSelected,onHighlightChange:this.handleHighlightChange,renderInput:function(e){return Object(a.jsx)($t.a,Object(w.a)(Object(w.a)({},e),{},{label:"Find Card...",variant:"outlined"}))}})})}}]),o}(n.Component),to=Object(d.c)((function(e){return{cardsDataEntities:ke(e)}}),{preview:H,clearPreview:W})(eo),oo={"02001a":"/card-game-playground/images/cards/8665869b-fae4-494e-91d1-1e8c308220c2.jpg","02001b":"/card-game-playground/images/cards/8665869b-fae4-494e-91d1-1e8c308220c2.b.jpg","02002a":"/card-game-playground/images/cards/cfd051be-4ade-4cf8-b575-4b673cfa9a92.jpg","02002b":"/card-game-playground/images/cards/cfd051be-4ade-4cf8-b575-4b673cfa9a92.b.jpg","02003a":"/card-game-playground/images/cards/b16187a4-3f29-4a4b-8b66-6e8c7524c402.jpg","02003b":"/card-game-playground/images/cards/b16187a4-3f29-4a4b-8b66-6e8c7524c402.b.jpg","02004":"/card-game-playground/images/cards/b35084d9-3a2b-418c-b1a4-e4929de16a2c.jpg","02004_double_sided_back":"/card-game-playground/images/cards/b35084d9-3a2b-418c-b1a4-e4929de16a2c.b.jpg","02005":"/card-game-playground/images/cards/1eae757a-25b2-4b29-a8e7-f43b12c531b0.jpg","02005_double_sided_back":"/card-game-playground/images/cards/1eae757a-25b2-4b29-a8e7-f43b12c531b0.b.jpg","02006a":"/card-game-playground/images/cards/0a59161d-7db6-4328-9eeb-1906ce8715a5.jpg","02006b":"/card-game-playground/images/cards/0a59161d-7db6-4328-9eeb-1906ce8715a5.b.jpg",12020:"https://lcgcdn.s3.amazonaws.com/mc/MC13en_20.jpg","15001a":"https://marvelcdb.com/bundles/cards/15001a.png","15001b":"https://marvelcdb.com/bundles/cards/15001b.png",15002:"https://hallofheroeshome.files.wordpress.com/2021/03/s1.jpg",15003:"https://hallofheroeshome.files.wordpress.com/2021/03/s2.jpg",15004:"https://hallofheroeshome.files.wordpress.com/2021/03/s6.jpg",15005:"https://hallofheroeshome.files.wordpress.com/2021/03/s7.jpg",15006:"https://hallofheroeshome.files.wordpress.com/2021/03/s10.jpg",15007:"https://hallofheroeshome.files.wordpress.com/2021/03/s11.jpg",15008:"https://hallofheroeshome.files.wordpress.com/2021/03/s12.jpg",15009:"https://hallofheroeshome.files.wordpress.com/2021/03/s15.jpg",15010:"https://hallofheroeshome.files.wordpress.com/2021/03/w1.jpg",15011:"https://hallofheroeshome.files.wordpress.com/2021/03/w2.jpg",15012:"https://hallofheroeshome.files.wordpress.com/2021/03/w3.jpg",15013:"https://hallofheroeshome.files.wordpress.com/2021/03/w4.jpg",15014:"https://hallofheroeshome.files.wordpress.com/2021/03/w5.jpg",15015:"https://hallofheroeshome.files.wordpress.com/2021/03/w6.jpg",15019:"https://hallofheroeshome.files.wordpress.com/2021/03/w10.jpg",15023:"https://hallofheroeshome.files.wordpress.com/2021/03/n2.jpg",15024:"https://hallofheroeshome.files.wordpress.com/2021/03/n3.jpg",15025:"https://hallofheroeshome.files.wordpress.com/2021/03/n4.jpg",15026:"https://hallofheroeshome.files.wordpress.com/2021/03/n5.jpg",15027:"https://hallofheroeshome.files.wordpress.com/2021/03/n6.jpg",15028:"https://hallofheroeshome.files.wordpress.com/2021/03/z1.jpg",15029:"https://hallofheroeshome.files.wordpress.com/2021/03/z2.jpg",15030:"https://hallofheroeshome.files.wordpress.com/2021/03/z3.jpg",15031:"https://hallofheroeshome.files.wordpress.com/2021/03/z4.jpg"},ao=o(149),no=o(324),ro=o(150),so=function(e){var t=r.a.useRef(null);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(no.a,{onClick:function(e){if(null===t||void 0===t?void 0:t.current){var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!1),t.current.dispatchEvent(o)}e.stopPropagation()},children:e.label}),Object(a.jsx)("input",{type:"file",ref:t,onChange:function(t){if(t.target.files&&t.target.files.length>0){var o=t.target.files[0];e.handleFile(o)}},style:{display:"none"}})]})},io=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(e){var n;return Object(At.a)(this,o),(n=t.call(this,e)).nestedRef=void 0,n.renderMenuItem=function(e,t){return e.children?Object(a.jsx)(ro.a,{ref:function(e){n.nestedRef=e},parentMenuOpen:n.state.menuOpen,label:e.label,onClick:function(e){n.nestedRef&&(e.stopPropagation(),n.nestedRef.parentElement.focus())},children:e.children.map((function(e,o){return n.renderMenuItem(e,1e3*t+o)}))},"contextMenu-item-".concat(t)):e.fileUploader?Object(a.jsx)(so,{label:e.label,handleFile:function(t){var o=new FileReader;o.readAsText(t,"UTF-8"),o.onload=function(t){var o,a=null===(o=t.target)||void 0===o?void 0:o.result;e.fileLoadedAction&&e.fileLoadedAction(a),n.props.hideContextMenu()}}},"contextMenu-item-".concat(t)):Object(a.jsx)(no.a,{onClick:n.handleContextItemClicked(e),children:e.label},"contextMenu-item-".concat(t))},n.handleMenuClosed=function(){n.setState({menuOpen:!1}),n.props.hideContextMenu()},n.preventDefault=function(e){e.preventDefault()},n.handleContextItemClicked=function(e){return function(){e.action&&e.action(),n.props.contextItemClicked&&n.props.contextItemClicked(n.props.items[0]),e.action&&(n.nestedRef&&n.nestedRef.blur(),n.props.hideContextMenu())}},n.state={menuOpen:!0},n}return Object(Ft.a)(o,[{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{id:"context-menu-layer",onContextMenu:this.preventDefault,onClick:function(t){var o;(null===(o=t.target)||void 0===o?void 0:o.files)||e.props.hideContextMenu()},children:Object(a.jsx)(ao.a,{keepMounted:!0,open:this.state.menuOpen,onClose:this.handleMenuClosed,anchorReference:"anchorPosition",anchorPosition:{top:this.props.position.y+8,left:this.props.position.x+8},children:this.props.items.map((function(t,o){return e.renderMenuItem(t,o)}))})})}}]),o}(n.Component),co=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){var e;Object(At.a)(this,o);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).touchTimer=null,e.cancelBubble=function(e){e.cancelBubble=!0},e.handleDecrement=function(){e.props.updateCounterValueBy(-1)},e.handleIncrement=function(){e.props.updateCounterValueBy(1)},e.handleTouchStart=function(t){t.cancelBubble=!0,e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout((function(){e.props.handleContextMenu(t)}),750)},e.handleTouchMove=function(t){e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null)},e.handleTouchEnd=function(t){e.touchTimer&&(clearTimeout(e.touchTimer),e.touchTimer=null)},e}return Object(Ft.a)(o,[{key:"render",value:function(){return Object(a.jsxs)(Wt.a,{x:this.props.pos.x,y:this.props.pos.y,draggable:!0,onClick:this.cancelBubble,onContextMenu:this.props.handleContextMenu,onDragEnd:this.props.onDragEnd,onTouchStart:this.handleTouchStart,onMouseDown:this.cancelBubble,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,children:[Object(a.jsx)(Wt.c,{cornerRadius:30,width:200,height:100,fill:this.props.color}),Object(a.jsx)(Wt.e,{width:200,height:100,fontSize:36,text:"".concat(this.props.value),align:"center",verticalAlign:"middle"}),Object(a.jsx)(Wt.e,{x:10,y:25,width:50,height:50,fontSize:36,text:"-",align:"center",verticalAlign:"middle",onClick:this.handleDecrement,onTap:this.handleDecrement}),Object(a.jsx)(Wt.e,{x:140,y:25,width:50,height:50,fontSize:36,text:"+",align:"center",verticalAlign:"middle",onClick:this.handleIncrement,onTap:this.handleIncrement})]})}}]),o}(n.Component),lo=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){var e;Object(At.a)(this,o);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).inputValue="",e.focusInputField=function(e){e&&setTimeout((function(){e.querySelector("input").focus()}),100)},e.cancelBubble=function(e){e.stopPropagation()},e.handleKeyPress=function(t){"enter"===t.key.toLocaleLowerCase()&&e.props.loadDeckId(+e.inputValue)},e}return Object(Ft.a)(o,[{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{onClick:this.cancelBubble,onKeyPress:this.cancelBubble,className:"token-field-row",children:[Object(a.jsx)($t.a,{ref:this.focusInputField,onKeyPress:this.handleKeyPress,onClick:this.cancelBubble,onChange:function(t){e.inputValue=t.target.value},type:"number",variant:"outlined"})," "]})}}]),o}(n.Component),uo=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){var e;Object(At.a)(this,o);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).handleSelected=function(t,o){if(o){var a=[],n=[],r=o.cards.filter((function(e){return!o.cards.some((function(t){return t.backLink===e.code}))}));r.filter((function(e){return"quest"===e.typeCode.toLocaleLowerCase()})).forEach((function(e){a=a.concat(Array.from({length:e.quantity}).map((function(t){return e.code})))})),r.filter((function(e){return"quest"!==e.typeCode.toLocaleLowerCase()})).forEach((function(e){n=n.concat(Array.from({length:e.quantity}).map((function(t){return e.code})))}));var s=[n];a.length>0&&(s=[a].concat(s)),e.props.loadCards(s)}},e.cancelBubble=function(e){e.stopPropagation()},e}return Object(Ft.a)(o,[{key:"render",value:function(){var e=this;return Object(a.jsx)("div",{onClick:this.cancelBubble,onKeyPress:this.cancelBubble,children:Object(a.jsx)(Xt.a,{id:"encounter-loader-combobox",options:this.props.encounterData||[],getOptionLabel:function(e){return e.setData.name},style:{width:300},onChange:this.handleSelected,renderInput:function(t){return Object(a.jsx)($t.a,Object(w.a)(Object(w.a)({},t),{},{label:Be[e.props.currentGameType].encounterUiName,variant:"outlined"}))}})})}}]),o}(n.Component),ho=Object(d.c)((function(e,t){return{encounterData:t.currentGameType===c.LordOfTheRingsLivingCardGame?Ie(e):Me(e)}}),{})(uo),po=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(e){var a;return Object(At.a)(this,o),(a=t.call(this,e)).cancelBubble=function(e){e.cancelBubble=!0},a.handleDragEnd=function(e){a.props.updatePos({x:e.target.x(),y:e.target.y()})},a.state={img:null},a}return Object(Ft.a)(o,[{key:"componentDidMount",value:function(){var e=this,t=new Image;t.onload=function(){e.setState({img:t})},t.src="/card-game-playground/images/table/first_player_token_"+this.props.currentGameType+".png"}},{key:"render",value:function(){var e,t,o,n,r,s,i,d,c;return Object(a.jsx)(Wt.c,{x:this.props.pos.x,y:this.props.pos.y,draggable:!0,onTouchStart:this.cancelBubble,onMouseDown:this.cancelBubble,onDragEnd:this.handleDragEnd,scale:{x:160/(null!==(e=null===(t=this.state.img)||void 0===t?void 0:t.naturalWidth)&&void 0!==e?e:1),y:160/(null!==(o=null===(n=this.state.img)||void 0===n?void 0:n.naturalWidth)&&void 0!==o?o:1)},width:null!==(r=null===(s=this.state.img)||void 0===s?void 0:s.naturalWidth)&&void 0!==r?r:0,height:null!==(i=null===(d=this.state.img)||void 0===d?void 0:d.naturalHeight)&&void 0!==i?i:0,fillPatternImage:null!==(c=this.state.img)&&void 0!==c?c:void 0})}}]),o}(n.Component),go=function(e){return e.liveState.present.counters},mo=Object(be.a)(go,(function(e){return e.counters})),fo=Object(be.a)(go,(function(e){return e.firstPlayerCounterPosition})),Co=Object(d.c)((function(e){return{pos:fo(e)}}),{updatePos:kt})(po),To=(o(277),function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){var e;Object(At.a)(this,o);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).inputRef=null,e.connect=function(t){var o,a;console.log("connecting with peer id "+(null===(o=e.inputRef)||void 0===o?void 0:o.value)),e.props.connect((null===(a=e.inputRef)||void 0===a?void 0:a.value)||"")},e.cancelBubble=function(e){e.stopPropagation()},e}return Object(Ft.a)(o,[{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{onClick:this.cancelBubble,onKeyPress:this.cancelBubble,children:[Object(a.jsx)("input",{ref:function(t){t&&(e.inputRef=t)}}),Object(a.jsx)("button",{onClick:this.connect,children:"Connect"})]})}}]),o}(n.Component)),vo=o(318),yo=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){var e;Object(At.a)(this,o);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).inputValue="0",e.focusInputField=function(e){e&&setTimeout((function(){e.querySelector("input").focus()}),100)},e.handleKeyPress=function(t){"enter"===t.key.toLocaleLowerCase()&&e.complete(+e.inputValue)},e.handleClick=function(t){e.complete(+e.inputValue)},e.complete=function(t){e.props.updated({id:e.props.id,tokenType:e.props.tokenType,value:t})},e.cancelBubble=function(e){e.stopPropagation()},e}return Object(Ft.a)(o,[{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{onClick:this.cancelBubble,onKeyPress:this.cancelBubble,className:"token-field-row",children:[Object(a.jsx)($t.a,{ref:this.focusInputField,onKeyPress:this.handleKeyPress,variant:"outlined",type:"number",onChange:function(t){e.inputValue=t.target.value}}),Object(a.jsx)(vo.a,{onClick:this.handleClick,style:{height:"56px",marginLeft:"5px"},variant:"outlined",color:"primary",children:"Set"})]})}}]),o}(n.Component),bo=(o(278),function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){var e;Object(At.a)(this,o);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).handleClick=function(t){t.stopPropagation(),e.props.completed()},e.preventDefault=function(e){e.preventDefault()},e}return Object(Ft.a)(o,[{key:"render",value:function(){var e={top:"".concat(this.props.position.y+8,"px"),left:"".concat(this.props.position.x+8,"px")};return Object(a.jsx)("div",{id:"top-layer",onClick:this.props.completed,onContextMenu:this.preventDefault,children:Object(a.jsx)("div",{className:"top-layer-content-wrapper",style:e,onContextMenu:this.preventDefault,onClick:this.handleClick,children:this.props.children})})}}]),o}(n.Component)),So=o(314),jo=(o(279),o(147)),ko=o.n(jo),xo=o(146),Oo=o.n(xo),wo=o(148),Po=o.n(wo),_o=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(){return Object(At.a)(this,o),t.apply(this,arguments)}return Object(Ft.a)(o,[{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{className:"touch-menu",children:[Object(a.jsx)(So.a,{className:this.props.panMode?"toggle-on":"",onClick:function(){e.props.togglePanMode()},children:Object(a.jsx)(Oo.a,{fontSize:"large"})}),Object(a.jsx)(So.a,{onClick:function(){e.props.flipCards()},children:Object(a.jsx)(ko.a,{fontSize:"large"})}),Object(a.jsx)(So.a,{onClick:function(){e.props.exhaustCard()},children:Object(a.jsx)(Po.a,{fontSize:"large"})})]})}}]),o}(n.Component),Io=Object(d.c)((function(e){return{panMode:Re(e)}}),{togglePanMode:ut,flipCards:ht,exhaustCard:st})(_o),Mo=function(e){Object(Bt.a)(o,e);var t=Object(Lt.a)(o);function o(e){var n;return Object(At.a)(this,o),(n=t.call(this,e)).stage=null,n.touchTimer=null,n.lastCenter=null,n.lastDist=0,n.handleCounterValueUpdate=function(e){return function(t){n.props.updateCounterValue({id:e,delta:t})}},n.handleCounterDrag=function(e){return function(t){n.props.moveCounter({id:e,newPos:{x:t.target.x(),y:t.target.y()}})}},n.noOp=function(){},n.renderEmptyMessage=function(){return n.props.cards.cards.length>0?null:Object(a.jsxs)("div",{children:["Right click and select 'Load Deck ID' to load a deck from"," ",Be[n.props.currentGameType].deckSite]})},n.renderContextMenu=function(){var e;if(!n.state.showContextMenu)return null;var t=null===(e=n.stage)||void 0===e?void 0:e.container().getBoundingClientRect(),o=n.state.contextMenuPosition;if(!t||!o)throw new Error("Problem computing context menu position");return Object(a.jsx)(io,{position:{x:t.left+o.x,y:t.top+o.y},items:n.state.contextMenuItems,hideContextMenu:function(){return n.clearContextMenu()}})},n.renderPreviewCardModal=function(){return n.state.previewCardModal?Object(a.jsx)(bo,{position:{x:0,y:0},completed:function(){n.props.clearPreviewCard(),n.setState({previewCardModal:!1})}}):null},n.renderTouchMenu=function(){return 0===n.props.cards.cards.length?null:Object(a.jsx)(Io,{})},n.renderDeckImporter=function(){var e;if(!n.state.showDeckImporter)return null;var t=null===(e=n.stage)||void 0===e?void 0:e.container().getBoundingClientRect(),o=n.state.deckImporterPosition;if(!t||!o)throw new Error("Problem computing deck importer position");return Object(a.jsx)(bo,{position:{x:t.left+o.x,y:t.top+o.y},completed:n.clearDeckImporter,children:Object(a.jsx)(lo,{loadDeckId:n.handleImportDeck(n.getRelativePositionFromTarget(n.stage))})})},n.renderEncounterImporter=function(){var e;if(!n.state.showEncounterImporter)return null;var t=null===(e=n.stage)||void 0===e?void 0:e.container().getBoundingClientRect(),o=n.state.encounterImporterPosition;if(!t||!o)throw new Error("Problem computing deck importer position");var r={x:t.left+o.x,y:t.top+o.y};return Object(a.jsx)(bo,{position:r,completed:n.clearEncounterImporter,children:Object(a.jsx)(ho,{currentGameType:n.props.currentGameType,loadCards:n.handleLoadEncounter(n.getRelativePositionFromTarget(n.stage))})})},n.renderCardSearch=function(){var e;if(!n.state.showCardSearch)return null;var t=null===(e=n.stage)||void 0===e?void 0:e.container().getBoundingClientRect(),o=n.state.cardSearchPosition;if(!t||!o)throw new Error("Problem computing card search position");var r={x:t.left+o.x,y:t.top+o.y};return n.state.cardStackForSearching?Object(a.jsx)(bo,{position:r,completed:n.clearCardSearch,children:Object(a.jsx)(to,{card:n.state.cardStackForSearching,cardSelected:n.handleCardSelectedFromCardStack(n.state.cardStackForSearching.id,r)})}):null},n.renderPeerConnector=function(){var e;if(!n.state.showPeerConnector)return null;var t=null===(e=n.stage)||void 0===e?void 0:e.container().getBoundingClientRect(),o=n.state.peerConnectorPosition;if(!t||!o)throw new Error("Problem computing peer connector position");var r={x:t.left+o.x,y:t.top+o.y};return n.state.showPeerConnector?Object(a.jsx)(bo,{position:r,completed:n.clearPeerConnector,children:Object(a.jsx)(To,{connect:n.handlePeerConnect})}):null},n.renderTokenModifier=function(){var e;if(!n.state.showTokenValueModifier)return null;var t=null===(e=n.stage)||void 0===e?void 0:e.container().getBoundingClientRect(),o=n.state.tokenValueModifierPosition;if(!t||!o)throw new Error("Problem computing token Modifier position");var r={x:t.left+o.x,y:t.top+o.y};return n.state.showTokenValueModifier&&n.state.tokenValueModifierProps?Object(a.jsx)(bo,{position:r,completed:n.clearTokenValueModifier,children:Object(a.jsx)(yo,{id:n.state.tokenValueModifierProps.id,tokenType:n.state.tokenValueModifierProps.tokenType,updated:function(e){n.props.adjustCounterToken(e),n.clearTokenValueModifier()}})}):null},n.handleLoadEncounter=function(e){return function(t){n.clearEncounterImporter(),t.forEach((function(t,o){n.props.addCardStack({position:{x:e.x+(ue+10)*o,y:e.y},cardJsonIds:t})}))}},n.handleImportDeck=function(e){return function(t){n.clearDeckImporter(),n.props.fetchDecklistById({gameType:n.props.currentGameType,decklistId:t,position:e})}},n.handlePeerConnect=function(e){n.clearPeerConnector(),n.props.connectToRemoteGame(e)},n.handleCardSelectedFromCardStack=function(e,t){return function(o){n.clearCardSearch(),n.props.pullCardOutOfCardStack({cardStackId:e,jsonId:o,pos:t})}},n.clearContextMenu=function(){n.setState({showContextMenu:!1,contextMenuPosition:null,contextMenuItems:[]})},n.clearDeckImporter=function(){n.setState({showDeckImporter:!1,deckImporterPosition:null})},n.clearTokenValueModifier=function(){n.setState({showTokenValueModifier:!1,tokenValueModifierProps:null,tokenValueModifierPosition:null})},n.clearEncounterImporter=function(){n.setState({showEncounterImporter:!1,encounterImporterPosition:null})},n.clearCardSearch=function(){n.setState({showCardSearch:!1,cardSearchPosition:null,cardStackForSearching:null})},n.clearPeerConnector=function(){n.setState({showPeerConnector:!1,peerConnectorPosition:null})},n.handleStageClickOrTap=function(e){if(!n.state.showContextMenu){var t=n.getRelativePositionFromTarget(n.stage);(n.props.panMode||ge(n.state.selectStartPos,t)<30)&&n.props.unselectAllCards()}},n.handleWheel=function(e){var t;if(e.evt.preventDefault(),n.stage){var o=n.props.gameState.stageZoom.x,a=null!==(t=n.stage.getPointerPosition())&&void 0!==t?t:{x:0,y:0},r=(a.x-n.stage.x())/o,s=(a.y-n.stage.y())/o,i=e.evt.deltaY<0?1.02*o:o/1.02;n.props.updateZoom({x:i,y:i});var d={x:a.x-r*i,y:a.y-s*i};n.props.updatePosition(d)}},n.handleCounterContextMenu=function(e){return function(t){var o,a;t.evt.preventDefault(),t.cancelBubble=!0;var r=n.props.counters.find((function(t){return t.id===e})),s=[{label:"Remove",action:function(){n.props.removeCounter(e)}},{label:"Reset",action:function(){var t;n.props.updateCounterValue({id:e,delta:-1*(null!==(t=null===r||void 0===r?void 0:r.value)&&void 0!==t?t:0)})}},{label:"Set Color",children:v.map((function(t){return{label:t,action:function(){n.props.updateCounterColor({id:e,newColor:t})}}}))}];n.setState({showContextMenu:!0,contextMenuPosition:null!==(o=null===(a=n.stage)||void 0===a?void 0:a.getPointerPosition())&&void 0!==o?o:null,contextMenuItems:s})}},n.handleCardContextMenu=function(e,t){var o,a,r;t.evt.preventDefault(),t.cancelBubble=!0;var s=n.props.cards.cards.find((function(t){return t.id===e}));n.props.selectCard({id:e,unselectOtherCards:!s||!s.selected});var i=n.props.cards.cards.find((function(t){return t.id===e})),d=(null===i||void 0===i||null===(o=i.cardStack)||void 0===o?void 0:o.length)||0,c=(null===i||void 0===i?void 0:i.statusTokens)||{stunned:!1,confused:!1,tough:!1},l=[{label:"Flip",action:function(){n.props.flipCards()}}];d>1&&(l.push({label:"Shuffle",action:function(){n.props.shuffleStack()}}),l.push({label:"Find Specific Card",action:function(){var e,t;i&&n.setState({showCardSearch:!0,cardSearchPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null,cardStackForSearching:i})}}));var u=Be[n.props.currentGameType].tokens;u.stunned&&l.push({label:c.stunned?u.stunned.menuRemoveText:u.stunned.menuText,action:function(){n.props.toggleToken({id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ue.Stunned,value:!c.stunned})}}),u.confused&&l.push({label:c.confused?u.confused.menuRemoveText:u.confused.menuText,action:function(){n.props.toggleToken({id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ue.Confused,value:!c.confused})}}),u.tough&&l.push({label:c.tough?u.tough.menuRemoveText:u.tough.menuText,action:function(){n.props.toggleToken({id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ue.Tough,value:!c.tough})}}),u.damage&&l.push({label:u.damage.menuText,action:function(){var e,t;n.setState({showContextMenu:!1,contextMenuItems:[],contextMenuPosition:null,showTokenValueModifier:!0,tokenValueModifierProps:{id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ve.Damage},tokenValueModifierPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null})}}),u.threat&&l.push({label:u.threat.menuText,action:function(){var e,t;n.setState({showContextMenu:!1,contextMenuItems:[],contextMenuPosition:null,showTokenValueModifier:!0,tokenValueModifierProps:{id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ve.Threat},tokenValueModifierPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null})}}),u.generic&&l.push({label:u.generic.menuText,action:function(){var e,t;n.setState({showContextMenu:!1,contextMenuItems:[],contextMenuPosition:null,showTokenValueModifier:!0,tokenValueModifierProps:{id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ve.Generic},tokenValueModifierPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null})}}),l.push({label:"Remove All Tokens",action:function(){n.props.adjustCounterToken({id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ve.Damage,value:0}),n.props.adjustCounterToken({id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ve.Threat,value:0}),n.props.adjustCounterToken({id:(null===i||void 0===i?void 0:i.id)||"",tokenType:Ve.Generic,value:0})}}),n.setState({showContextMenu:!0,contextMenuPosition:null!==(a=null===(r=n.stage)||void 0===r?void 0:r.getPointerPosition())&&void 0!==a?a:null,contextMenuItems:l})},n.handleCardClick=function(e){return function(t,o){var a=o.evt.shiftKey||o.evt.metaKey||o.evt.ctrlKey;e.selected&&a?n.props.toggleSelectCard(t):n.props.selectCard({id:t,unselectOtherCards:!a})}},n.handleSelectAndExhaust=function(e,t){var o=t.evt.shiftKey||t.evt.metaKey||t.evt.ctrlKey;n.props.selectCard({id:e,unselectOtherCards:!o}),n.props.exhaustCard(e)},n.showOrToggleModalPreviewCard=function(e,t){n.props.gameState.previewCard&&n.props.gameState.previewCard.id===e?n.props.clearPreviewCard():(n.setState({previewCardModal:!0}),n.props.setPreviewCardId(e))},n.handleCardDragStart=function(e,t){var o=!1;if(!(n.props.cards.cards.filter((function(e){return e.selected&&e.controlledBy===C})).length>1)){var a=n.props.cards.cards.find((function(t){return t.id===e})),r=((null===a||void 0===a?void 0:a.cardStack)||[]).length>1;if(a&&r){var s={x:a.x+(a.exhausted?le:ue)/2,y:a.y-(a.exhausted?ue:le)/2};ge(s,n.getRelativePositionFromTarget(n.stage))<50&&(o=!0)}}n.props.startCardMove({id:e,splitTopCard:o})},n.handleKeyPress=function(e){var t=e.ctrlKey||e.metaKey,o=e.key.toLocaleLowerCase(),a=parseInt(o);if("p"===o)n.props.togglePanMode();else if("f"===o)n.props.flipCards();else if("e"===o)n.props.exhaustCard();else if("s"===o)n.props.shuffleStack();else if(!Number.isNaN(a))if(t);else{var r=n.props.cards.cards.filter((function(e){return e.selected&&e.controlledBy===C}));1!==r.length?console.log("will not be drawing any cards because the number of selected stacks is "+r.length):n.props.drawCardsOutOfCardStack({cardStackId:r[0].id,numberToDraw:a})}},n.handleKeyDown=function(e){var t=e.key.toLocaleLowerCase(),o=parseInt(t);if((e.ctrlKey||e.metaKey)&&!Number.isNaN(o)){var a=Be[n.props.currentGameType].tokens;switch(o){case 1:a.damage&&n.props.adjustCounterToken({tokenType:Ve.Damage,delta:1});break;case 2:a.threat&&n.props.adjustCounterToken({tokenType:Ve.Threat,delta:1});break;case 3:a.generic&&n.props.adjustCounterToken({tokenType:Ve.Generic,delta:1});break;case 4:a.damage&&n.props.adjustCounterToken({tokenType:Ve.Damage,delta:-1});break;case 5:a.threat&&n.props.adjustCounterToken({tokenType:Ve.Threat,delta:-1});break;case 6:a.generic&&n.props.adjustCounterToken({tokenType:Ve.Generic,delta:-1})}e.preventDefault()}e.shiftKey&&(e.ctrlKey||e.metaKey)&&"z"===e.key?n.props.redo():(e.ctrlKey||e.metaKey)&&"z"===e.key&&(e.preventDefault(),n.props.undo())},n.getRawPreviewCardPosition=function(e){var t,o,a=null!==(t=null===(o=n.stage)||void 0===o?void 0:o.getPointerPosition())&&void 0!==t?t:{x:0,y:0},r=window.innerWidth/2,s=window.innerHeight/2,i=e?he:pe,d=e?pe:he;return n.state.previewCardModal?{x:r,y:s}:a.x<r?{x:window.innerWidth-i/2,y:d/2}:{x:i/2,y:d/2}},n.getRelativePositionFromTarget=function(e,t){var o=e.getAbsoluteTransform().copy();o.invert();var a=t||e.getPointerPosition();return o.point(a)},n.handleMouseDown=function(e){if(e.evt instanceof MouseEvent&&0===e.evt.button||e.evt instanceof TouchEvent){var t=n.getRelativePositionFromTarget(n.stage);n.setState({selectStartPos:{x:t.x,y:t.y},selecting:!0})}return!1},n.getSelectionRectInfo=function(){var e=n.state.selectStartPos,t=n.state.selectRect;return{height:Math.abs(t.height),width:Math.abs(t.width),x:t.width<0?e.x+t.width:e.x,y:t.height<0?e.y+t.height:e.y}},n.handleMouseUp=function(){if(n.state.drewASelectionRect){var e=n.getSelectionRectInfo(),t=n.props.cards.cards.reduce((function(t,o){return Gt.boxBox(e.x,e.y,e.width,e.height,o.x-50,o.y-75,ue,le)&&t.push(o),t}),[]);n.props.selectMultipleCards({ids:t.map((function(e){return e.id}))})}return n.setState({drewASelectionRect:!1,selectRect:{height:0,width:0},selecting:!1}),!1},n.handleTouchStart=function(e){n.touchTimer&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout((function(){n.handleContextMenu(e)}),750),n.props.panMode||n.handleMouseDown(e)},n.handleTouchMove=function(e){e.evt.preventDefault();var t=e.evt.touches[0],o=e.evt.touches[1];n.touchTimer&&(clearTimeout(n.touchTimer),n.touchTimer=null),t&&o?n.handleMultiTouch(t,o):n.handleMouseMove(e)},n.handleMultiTouch=function(e,t){if(n.stage){n.stage.isDragging()&&n.stage.stopDrag();var o={x:e.clientX,y:e.clientY},a={x:t.clientX,y:t.clientY};if(n.lastCenter){var r=me(o,a),s=ge(o,a);n.lastDist||(n.lastDist=s);var i=(r.x-n.stage.x())/n.props.gameState.stageZoom.x,d=(r.y-n.stage.y())/n.props.gameState.stageZoom.y,c=n.props.gameState.stageZoom.x*(s/n.lastDist);n.props.updateZoom({x:c,y:c});var l=r.x-n.lastCenter.x,u=r.y-n.lastCenter.y,h={x:r.x-i*c+l,y:r.y-d*c+u};n.props.updatePosition(h),n.lastDist=s,n.lastCenter=r}else n.lastCenter=me(o,a)}},n.handleTouchEnd=function(e){n.lastDist=0,n.lastCenter=null,n.touchTimer&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.props.panMode||n.handleMouseUp()},n.handleMouseMove=function(e){if(n.state.selecting){var t=n.getRelativePositionFromTarget(e.currentTarget);n.setState({drewASelectionRect:!0,selectRect:{height:t.y-n.state.selectStartPos.y,width:t.x-n.state.selectStartPos.x}})}e.cancelBubble=!0},n.handleContextMenu=function(e){var t,o;n.touchTimer&&(clearTimeout(n.touchTimer),n.touchTimer=null),e.evt.preventDefault(),e.cancelBubble=!0;var a=[{label:"Undo",action:n.props.undo},{label:"Redo",action:n.props.redo},{label:"Load Deck by ID",action:function(){var e,t;n.setState({showDeckImporter:!0,deckImporterPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null})}},{label:"Load Deck from txt file",fileLoadedAction:function(e){var t,o;n.props.createDeckFromTxt({gameType:n.props.currentGameType,position:null!==(t=null===(o=n.stage)||void 0===o?void 0:o.getPointerPosition())&&void 0!==t?t:{x:0,y:0},txtContents:e})},fileUploader:!0},{label:"Load ".concat(Be[n.props.currentGameType].encounterUiName),action:function(){var e,t;n.setState({showEncounterImporter:!0,encounterImporterPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null})}},{label:"Create new counter",action:function(){var e;n.props.addNewCounter(null!==(e=n.getRelativePositionFromTarget(n.stage))&&void 0!==e?e:{x:0,y:0})}},{label:"Reset Game",action:n.props.resetApp},{label:"Quit Game",action:function(){n.props.quitGame(),n.props.resetApp()}},{label:"Connect to Remote Game",action:function(){var e,t;n.setState({showPeerConnector:!0,peerConnectorPosition:null!==(e=null===(t=n.stage)||void 0===t?void 0:t.getPointerPosition())&&void 0!==e?e:null})}},{label:"Request resync from Remote Game",action:n.props.requestResync},{label:"Peer id is ".concat(n.props.peerId),action:function(){}}];n.setState({showContextMenu:!0,contextMenuPosition:null!==(t=null===(o=n.stage)||void 0===o?void 0:o.getPointerPosition())&&void 0!==t?t:null,contextMenuItems:a})},n.getCardType=function(e){var t;if(0===Object.keys(n.props.cardsData).length)return"";var o=n.props.cardsData[e.cardStack[0].jsonId];return(null!==(t=null===o||void 0===o?void 0:o.typeCode)&&void 0!==t?t:"").toLocaleLowerCase()},n.getCardName=function(e){var t,o,a=e.faceup?e.cardStack[0]:e.cardStack[e.cardStack.length-1];return null!==(t=null===(o=n.props.cardsData[a.jsonId])||void 0===o?void 0:o.name)&&void 0!==t?t:""},n.getCardCode=function(e){var t,o,a=e.faceup?e.cardStack[0]:e.cardStack[e.cardStack.length-1];return null!==(t=null===(o=n.props.cardsData[a.jsonId])||void 0===o?void 0:o.code)&&void 0!==t?t:"code missing for ".concat(a.jsonId)},n.getImgUrls=function(e){if(0===Object.keys(n.props.cardsData).length)return[];var t=[],o=n.props.cardsData[e.cardStack[0].jsonId];if(!o)return[];var a=o;if(a.images)return e.faceup?[a.images.front]:a.images.back?[a.images.back]:["encounter"===o.extraInfo.factionCode?"/card-game-playground/images/standard/encounter_card_back_"+n.props.currentGameType+".png":"/card-game-playground/images/standard/card_back_"+n.props.currentGameType+".png"];e.faceup||o.backLink||o.doubleSided?t=[n.generateLCGCDNImageUrl(o,e.faceup)]:(a=null,t=["encounter"===o.extraInfo.factionCode?"/card-game-playground/images/standard/encounter_card_back_"+n.props.currentGameType+".png":"/card-game-playground/images/standard/card_back_"+n.props.currentGameType+".png"]);var r="";a&&(e.faceup?r=a.code:a.backLink?r=a.backLink:a.doubleSided&&(r="".concat(a.code,"_double_sided_back")));var s=a?n.checkMissingImageMap(r):null;return s&&t.unshift(s),t},Ht.a&&(Ht.a.hitOnDragEnabled=!0),n.state={drewASelectionRect:!1,selectRect:{height:0,width:0},selectStartPos:{x:0,y:0},selecting:!1,showContextMenu:!1,contextMenuPosition:null,contextMenuItems:[],showDeckImporter:!1,deckImporterPosition:null,showEncounterImporter:!1,encounterImporterPosition:null,showCardSearch:!1,cardSearchPosition:null,cardStackForSearching:null,showPeerConnector:!1,peerConnectorPosition:null,showTokenValueModifier:!1,tokenValueModifierProps:null,tokenValueModifierPosition:null,playmatImage:null,previewCardModal:!1},n}return Object(Ft.a)(o,[{key:"componentDidMount",value:function(){var e=this,t=new Image;t.onload=function(){e.setState({playmatImage:t})},t.src="/card-game-playground"+Be[this.props.currentGameType].backgroundImageLocation,this.props.loadCardsData(),this.props.allJsonData("")}},{key:"render",value:function(){var e=this;if(document.activeElement===document.body){var t=document.querySelector(".play-area");null===t||void 0===t||t.focus()}var o=this.props.cards.cards.filter((function(e){return!e.dragging})).map((function(t){var o,n,r;return Object(a.jsx)(Yt,{currentGameType:e.props.currentGameType,code:e.getCardCode(t),name:e.getCardName(t),selectedColor:null!==(o=e.props.playerColors[t.controlledBy])&&void 0!==o?o:"black",controlledBy:t.controlledBy,id:t.id,x:t.x,y:t.y,exhausted:t.exhausted,fill:t.fill,selected:t.selected,dropTargetColor:null!==(n=e.props.playerColors[null===(r=e.props.dropTargetCardsById[t.id])||void 0===r?void 0:r.ownerRef])&&void 0!==n?n:"",dragging:t.dragging,shuffling:t.shuffling,handleDragStart:e.handleCardDragStart,handleDragMove:e.props.cardMove,handleDragEnd:e.props.endCardMove,handleDoubleClick:e.handleSelectAndExhaust,handleDoubleTap:e.showOrToggleModalPreviewCard,handleClick:e.handleCardClick(t),handleHover:e.props.setPreviewCardId,handleHoverLeave:e.props.clearPreviewCard,handleContextMenu:e.handleCardContextMenu,imgUrls:e.getImgUrls(t),typeCode:e.getCardType(t),faceup:t.faceup,numCardsInStack:t.cardStack.length,cardState:{stunned:t.statusTokens.stunned,confused:t.statusTokens.confused,tough:t.statusTokens.tough,tokens:{damage:0,threat:0,generic:0}}},t.id)})),n=this.props.cards.ghostCards.map((function(t){var o;return Object(a.jsx)(Yt,{currentGameType:e.props.currentGameType,name:e.getCardName(t),code:e.getCardCode(t),selectedColor:null!==(o=e.props.playerColors[t.controlledBy])&&void 0!==o?o:"black",controlledBy:t.controlledBy,id:t.id,x:t.x,y:t.y,exhausted:t.exhausted,fill:t.fill,selected:!1,dragging:!1,shuffling:!1,imgUrls:e.getImgUrls(t),typeCode:e.getCardType(t),faceup:t.faceup,isGhost:!0},"ghost".concat(t.id))})),r=this.props.cards.cards.filter((function(e){return e.dragging})).map((function(t){var o;return Object(a.jsx)(Yt,{currentGameType:e.props.currentGameType,name:e.getCardName(t),code:e.getCardCode(t),selectedColor:null!==(o=e.props.playerColors[t.controlledBy])&&void 0!==o?o:"black",controlledBy:t.controlledBy,id:t.id,x:t.x,y:t.y,exhausted:t.exhausted,fill:t.fill,selected:t.selected,dragging:t.dragging,shuffling:t.shuffling,handleDragStart:e.handleCardDragStart,handleDragMove:e.props.cardMove,handleDragEnd:e.props.endCardMove,imgUrls:e.getImgUrls(t),typeCode:e.getCardType(t),faceup:t.faceup,numCardsInStack:t.cardStack.length},t.id)})),s=this.props.cards.cards.some((function(e){return e.dragging&&e.controlledBy===C})),i=this.props.menuPreviewCard?[this.props.menuPreviewCard]:this.props.cards.cards.filter((function(t){return!!e.props.gameState.previewCard&&t.id===e.props.gameState.previewCard.id})),c=this.stage?i.filter((function(t){return!e.state.selecting&&!s})).map((function(t){var o,n=qt.includes(e.getCardType(t)),r=e.getImgUrls(t),s=e.getRawPreviewCardPosition(n),i=e.getRelativePositionFromTarget(e.stage,s);return r.some((function(e){return-1!==e.indexOf("card_back")}))?null:Object(a.jsx)(Yt,{currentGameType:e.props.currentGameType,name:e.getCardName(t),code:e.getCardCode(t),selectedColor:null!==(o=e.props.playerColors[t.controlledBy])&&void 0!==o?o:"black",controlledBy:t.controlledBy,id:t.id,x:i.x,y:i.y,exhausted:n,fill:t.fill,selected:!1,dragging:!1,shuffling:!1,imgUrls:r,typeCode:e.getCardType(t),faceup:t.faceup,height:he/e.props.gameState.stageZoom.y,width:pe/e.props.gameState.stageZoom.x},"preview".concat(t.id))})).filter((function(e){return null!==e})):[];return Object(a.jsxs)("div",{className:"play-area",tabIndex:1,onKeyDown:this.handleKeyDown,onKeyPress:this.handleKeyPress,children:[this.renderEmptyMessage(),this.renderContextMenu(),this.renderPreviewCardModal(),this.renderTouchMenu(),this.renderDeckImporter(),this.renderEncounterImporter(),this.renderCardSearch(),this.renderPeerConnector(),this.renderTokenModifier(),Object(a.jsx)(d.b.Consumer,{children:function(t){var s,i,l,u,h,p,g,m,f,C=t.store;return Object(a.jsx)(Wt.d,{ref:function(t){t&&(e.stage=t)},x:e.props.gameState.stagePosition.x,y:e.props.gameState.stagePosition.y,width:window.innerWidth,height:window.innerHeight,onClick:e.handleStageClickOrTap,onTap:e.handleStageClickOrTap,onMouseDown:e.props.panMode?e.noOp:e.handleMouseDown,onMouseUp:e.props.panMode?e.noOp:e.handleMouseUp,onMouseMove:e.props.panMode?e.noOp:e.handleMouseMove,onTouchStart:e.handleTouchStart,onTouchMove:e.handleTouchMove,onTouchEnd:e.handleTouchEnd,onContextMenu:e.handleContextMenu,scale:e.props.gameState.stageZoom,onWheel:e.handleWheel,draggable:e.props.panMode,onDragMove:e.noOp,onDragEnd:e.noOp,preventDefault:!0,children:Object(a.jsxs)(d.a,{store:C,children:[Object(a.jsx)(Wt.b,{children:Object(a.jsx)(Wt.c,{scale:{x:2880/(null!==(s=null===(i=e.state.playmatImage)||void 0===i?void 0:i.naturalWidth)&&void 0!==s?s:1),y:2880/(null!==(l=null===(u=e.state.playmatImage)||void 0===u?void 0:u.naturalWidth)&&void 0!==l?l:1)},width:null!==(h=null===(p=e.state.playmatImage)||void 0===p?void 0:p.naturalWidth)&&void 0!==h?h:0,height:null!==(g=null===(m=e.state.playmatImage)||void 0===m?void 0:m.naturalHeight)&&void 0!==g?g:0,fillPatternImage:null!==(f=e.state.playmatImage)&&void 0!==f?f:void 0})}),Object(a.jsx)(Wt.b,{children:e.props.counters.map((function(t){return Object(a.jsx)(co,{id:t.id,pos:t.position,value:t.value,color:t.color,updateCounterValueBy:e.handleCounterValueUpdate(t.id),handleContextMenu:e.handleCounterContextMenu(t.id),onDragEnd:e.handleCounterDrag(t.id)},"".concat(t.id,"-counter"))}))}),Object(a.jsxs)(Wt.b,{preventDefault:!0,children:[n.concat(o).concat(r),Object(a.jsx)(Co,{currentGameType:e.props.currentGameType}),c]}),Object(a.jsx)(Wt.b,{children:Object(a.jsx)(Wt.c,{x:e.state.selectStartPos.x,y:e.state.selectStartPos.y,width:e.state.selectRect.width,height:e.state.selectRect.height,stroke:"yellow",strokeWidth:4})})]})})}})]})}},{key:"checkMissingImageMap",value:function(e){var t;return null!==(t=oo[e])&&void 0!==t?t:null}},{key:"generateLCGCDNImageUrl",value:function(e,t){var o,a;if(!e)return"https://lcgcdn.s3.amazonaws.com/mc/NOPE.jpg";var n=e.code;!t&&e.backLink&&(n=e.backLink);for(var r=null!==(o=Ae[null!==(a=e.extraInfo.packCode)&&void 0!==a?a:""])&&void 0!==o?o:n.substring(0,2),s=n.substring(2);"0"===s[0];)s=s.substring(1);s=s.toLocaleUpperCase();var i="";return e.doubleSided&&(i=t?"A":"B"),"https://lcgcdn.s3.amazonaws.com/mc/MC".concat(r,"en_").concat(s).concat(i,".jpg")}}]),o}(n.Component),Do=["ant.json","ant_encounter.json","bkw.json","bkw_encounter.json","cap.json","cap_encounter.json","core.json","core_encounter.json","drs.json","drs_encounter.json","gob_encounter.json","hlk.json","hlk_encounter.json","msm.json","msm_encounter.json","qsv.json","qsv_encounter.json","ron_encounter.json","scw.json","scw_encounter.json","thor.json","thor_encounter.json","toafk_encounter.json","trors.json","trors_encounter.json","twc_encounter.json","wsp.json","wsp_encounter.json"],No=["A Journey To Rhosgobel.json","A Journey to Rhosgobel Nightmare.json","A Knife in the Dark Nightmare.json","A Shadow in the East.json","A Shadow of the Past Nightmare.json","A Storm on Cobas Haven Nightmare.json","A Storm on Cobas Haven.json","Across the Ettenmoors Nightmare.json","Across the Ettenmoors.json","Among the Outlaws.json","Assault on Osgiliath Nightmare.json","Assault on Osgiliath.json","Attack on Dol Guldur.json","Beneath the Sands.json","Breaking of the Fellowship Nightmare.json","Celebrimbor's Secret Nightmare.json","Celebrimbor's Secret.json","Challenge of the Wainriders.json","Children of Eorl.json","Conflict at the Carrock Nightmare.json","Conflict at the Carrock.json","Core Set.json","Deadmen's Dike Nightmare.json","Dungeons Deep and Caverns Dim Nightmare.json","Encounter at Amon D\xeen Nightmare.json","Encounter at Amon D\xeen.json","Escape From Dol Guldur Nightmare.json","Escape from Khazad-d\xfbm.json","Escape from Mount Gram Nightmare.json","Escape from Mount Gram.json","Fire in the Night.json","First Age.json","Flies and Spiders Nightmare.json","Flight from Moria Nightmare.json","Flight of the Stormcaller Nightmare.json","Flight of the Stormcaller.json","Flight to the Ford Nightmare.json","Fog on the Barrow-downs.json","Foundations of Stone Nightmare.json","Foundations of Stone.json","Heirs of N\xfamenor.json","Helm's Deep Nightmare.json","Into Fangorn Nightmare.json","Into Ithilien Nightmare.json","Into the Pit Nightmare.json","Intruders in Chetwood Nightmare.json","Journey Along the Anduin Nightmare.json","Journey in the Dark Nightmare.json","Journey to the Cross-roads Nightmare.json","Khazad-d\xfbm.json","Mount Gundabad.json","Murder at the Prancing Pony.json","Over the Misty Mountains Grim Nightmare.json","Passage Through Mirkwood Nightmare.json","Peril in Pelargir Nightmare.json","Race Across Harad.json","Raid on the Grey Havens Nightmare.json","Return to Mirkwood Nightmare.json","Return to Mirkwood.json","Road to Rivendell Nightmare.json","Road to Rivendell.json","Roam Across Rhovanion.json","Shadow and Flame Nightmare.json","Shadow and Flame.json","Shelob's Lair Nightmare.json","Temple of the Deceived Nightmare.json","Temple of the Deceived.json","The Antlered Crown Nightmare.json","The Antlered Crown.json","The Battle of Carn D\xfbm Nightmare.json","The Battle of Carn D\xfbm.json","The Battle of Five Armies Nightmare.json","The Battle of Lake-town.json","The Betrayal of M\xeem.json","The Black Riders.json","The Black Serpent.json","The Blood of Gondor Nightmare.json","The Blood of Gondor.json","The City of Corsairs Nightmare.json","The City of Corsairs.json","The City of Ulfast.json","The Crossings of Poros.json","The Dead Marshes Nightmare.json","The Dead Marshes.json","The Dread Realm Nightmare.json","The Dread Realm.json","The Drowned Ruins Nightmare.json","The Drowned Ruins.json","The Dr\xfaadan Forest Nightmare.json","The Dr\xfaadan Forest.json","The Dungeons of Cirith Gurat.json","The Dunland Trap Nightmare.json","The Dunland Trap.json","The Fall of Nargothrond.json","The Fate of N\xfamenor Nightmare.json","The Fate of Wilderland.json","The Flame of the West.json","The Fords of Isen Nightmare.json","The Fortress of Nurn.json","The Ghost of Framsburg.json","The Grey Havens.json","The Hills of Emyn Muil Nightmare.json","The Hills of Emyn Muil.json","The Hobbit: On the Doorstep.json","The Hobbit: Over Hill and Under Hill.json","The Hunt for Gollum Nightmare.json","The Hunt for Gollum.json","The Hunt for the Dreadnaught.json","The Land of Shadow.json","The Land of Sorrow.json","The Lonely Mountain Nightmare.json","The Long Dark Nightmare.json","The Long Dark.json","The Lost Realm.json","The Massing at Osgiliath.json","The Mines of Moria.json","The Morgul Vale Nightmare.json","The Morgul Vale.json","The Mountain of Fire.json","The M\xfbmakil.json","The N\xeen-in-Eilph Nightmare.json","The N\xeen-in-Eilph.json","The Old Forest.json","The Passage of the Marshes Nightmare.json","The Redhorn Gate Nightmare.json","The Redhorn Gate.json","The Ring Goes South Nightmare.json","The Road Darkens.json","The Road to Isengard Nightmare.json","The Ruins of Belegost.json","The Sands of Harad.json","The Seventh Level Nightmare.json","The Siege of Ann\xfaminas.json","The Siege of Cair Andros Nightmare.json","The Steward's Fear Nightmare.json","The Steward's Fear.json","The Stone of Erech.json","The Thing in the Depths Nightmare.json","The Thing in the Depths.json","The Three Trials Nightmare.json","The Three Trials.json","The Treachery of Rhudaur Nightmare.json","The Treachery of Rhudaur.json","The Treason of Saruman.json","The Uruk-hai Nightmare.json","The Voice of Isengard.json","The Wastes of Eriador Nightmare.json","The Wastes of Eriador.json","The Watcher in the Water Nightmare.json","The Watcher in the Water.json","The Weather Hills Nightmare.json","The Wilds of Rhovanion.json","The Withered Heath.json","The Wizard's Quest.json","The Woodland Realm.json","To Catch an Orc Nightmare.json","Trial Upon the Marches.json","Trouble in Tharbad Nightmare.json","Trouble in Tharbad.json","Two-Player Limited Edition Starter.json","Under the Ash Mountains.json","Voyage Across Belegaer Nightmare.json","We Must Away, Ere Break of Day Nightmare.json","Wrath and Ruin.json"],Ro=function(){var e=Object(Te.a)(Ce.a.mark((function e(t){var o;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get("/card-game-playground/json_data/"+t);case 2:return o=e.sent,e.abrupt("return",{res:o,packCode:t.split(".json")[0]});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Eo=function(){var e=Object(Te.a)(Ce.a.mark((function e(t){var o;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get("/card-game-playground/json_data/"+t);case 2:return o=e.sent,e.abrupt("return",{res:o,packCode:t.split(".json")[0]});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ao=function(){var e=Object(Te.a)(Ce.a.mark((function e(t){var o;return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get("/card-game-playground/json_data/scenarios/"+t+".json");case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fo=function(e){return e.game},Bo=(Object(be.a)(Fo,(function(e){return e.stageZoom})),Object(be.a)(Fo,(function(e){return e.playerColors}))),Lo=Object(be.a)(Fo,(function(e){return e.peerId})),Go=Object(be.a)(Fo,(function(e){return e.activeGameType})),Qo=Object(be.a)(Fo,(function(e){return e.menuPreviewCardJsonId?{id:"menu-preview-card",controlledBy:"",exhausted:!1,faceup:!0,fill:"gray",x:0,y:0,statusTokens:{stunned:!1,confused:!1,tough:!1},counterTokens:{damage:0,threat:0,generic:0},selected:!1,dragging:!1,shuffling:!1,cardStack:[{jsonId:e.menuPreviewCardJsonId}]}:null})),Ho=Object(d.c)((function(e){return{playerColors:Bo(e),cards:De(e),cardsData:ke(e),panMode:Re(e),gameState:Fo(e),counters:mo(e),peerId:Lo(e),dropTargetCardsById:Ee(e),menuPreviewCard:Qo(e)}}),{cardMove:it,endCardMove:dt,exhaustCard:st,loadCardsData:X,allJsonData:function(){return function(){var e=Object(Te.a)(Ce.a.mark((function e(t){return Ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Do.map((function(e){return Ro(e)})));case 2:return e.sent.forEach((function(e){200===e.res.status?t($({packType:c.MarvelChampions,pack:e.res.data,pack_code:e.packCode})):console.error("Failed to load some json data")})),e.next=6,Promise.all(No.map((function(e){return Eo(e)})));case 6:return e.sent.forEach((function(e){200===e.res.status?t($({packType:c.LordOfTheRingsLivingCardGame,pack:e.res.data,pack_code:e.packCode})):console.error("Failed to load some json data")})),e.next=10,Promise.all(k.map((function(e){return Ao(e.Title)})));case 10:e.sent.forEach((function(e){200===e.status?t(ee({setCode:e.data.Slug,cards:e.data.AllCards})):console.error("Failed to load some json data")}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},selectCard:at,unselectCard:nt,toggleSelectCard:rt,selectMultipleCards:ct,startCardMove:function(e){return function(t){var o=Object(w.a)(Object(w.a)({},e),{},{splitCardId:Object(f.a)()});t(re(o))}},unselectAllCards:lt,togglePanMode:ut,flipCards:ht,shuffleStack:function(e){return function(t,o){var a=De(o());(e?[a.cards.find((function(t){return t.id===e}))]:a.cards.filter((function(e){return e.selected&&e.controlledBy===C}))).filter((function(e){return!!e&&e.cardStack.length>1})).forEach((function(e){t(ie({id:e.id,shuffling:!0}));var o=He(e.cardStack);t(se({id:e.id,newStack:o})),setTimeout((function(){t(ie({id:e.id,shuffling:!1}))}))}))}},fetchDecklistById:Le,updateZoom:R,updatePosition:E,resetApp:x,addCardStack:function(e){return function(t){var o=Object(w.a)(Object(w.a)({},e),{},{id:Object(f.a)()});t(oe(o))}},toggleToken:pt,adjustCounterToken:gt,pullCardOutOfCardStack:function(e){return function(t){var o=Object(w.a)(Object(w.a)({},e),{},{id:Object(f.a)()});t(ae(o))}},addNewCounter:function(e){return function(t){var o={pos:e,id:Object(f.a)()};t(ft(o))}},updateCounterValue:bt,removeCounter:St,moveCounter:jt,connectToRemoteGame:A,requestResync:L,undo:g.ActionCreators.undo,redo:g.ActionCreators.redo,drawCardsOutOfCardStack:function(e){return function(t){var o=Array.from({length:e.numberToDraw}).map((function(e){return Object(f.a)()})),a=Object(w.a)(Object(w.a)({},e),{},{idsToUse:o});t(ne(a))}},setPreviewCardId:G,clearPreviewCard:Q,quitGame:V,updateCounterColor:xt,createDeckFromTxt:function(e){return function(t,o){if(e.gameType===c.MarvelChampions){var a=Oe(o()),n=we(o());t(de(Ge(function(e,t,o,a){var n=a.split("\n").map((function(e){return e.trim()})).filter((function(e){return!!e})),r="",s=n.findIndex((function(e){return e.toLocaleLowerCase().startsWith("pack")}));-1!==s&&(r=n[s-1]);var i=e[r];if(!i)throw new Error("Could not find hero with name ".concat(r));var d=/^\dx/,c=n.filter((function(e){var t;return 0===(null===(t=e.match(d))||void 0===t?void 0:t.index)})),l={};return c.forEach((function(e){var o=parseInt(e[0]);if(Number.isNaN(o))throw new Error("Could not get number from txt file for card");var a=e.split(d)[1].split("(")[0].trim(),n=t[a];l[n.code]=o})),console.log(r),{data:{investigator_code:i.code,slots:l}}}(a,n,e.position,e.txtContents),o(),{gameType:e.gameType,decklistId:-1,position:e.position})))}}}})(Mo),Wo=(o(280),o(321)),Uo=o(317),Vo=o(323),Ko=function(e){return Object(a.jsxs)("div",{className:"game-picker",children:[Object(a.jsx)("h1",{children:"Card Game Playground"}),Object(a.jsxs)(Uo.a,{className:"select",children:[Object(a.jsx)(Vo.a,{id:"game-picker-label",children:"Select Game"}),Object(a.jsx)(Wo.a,{id:"game-picker",labelId:"game-picker-label",onChange:function(t){e.updateActiveGameType(t.target.value)},children:Object.entries(c).map((function(e){var t=Object(y.a)(e,2),o=t[0],n=t[1],r=o.replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()}));return Object(a.jsx)(no.a,{value:n,children:r})}))})]})]})},Jo=function(e){return e.activeGameType?Object(a.jsx)(Ho,{currentGameType:e.activeGameType}):Ko(e)},zo=Object(d.c)((function(e){return{activeGameType:Go(e)}}),{updateActiveGameType:U})(Jo),qo=function(){console.log("configuring store. NODE_ENV is production");var e=Object(h.a)({reducer:Pt,middleware:Et,devTools:!1});return e.subscribe(u()((function(){!function(e){var t=["cardsData"];try{Object.entries(e).forEach((function(e){var o=Object(y.a)(e,2),a=o[0],n=o[1];if(!t.includes(a)){var r=JSON.stringify(n);localStorage.setItem(a,r)}}))}catch(o){console.error("Error writing state to local storage")}}(e.getState())}),1e3)),e}();i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(d.a,{store:qo,children:Object(a.jsx)(zo,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},79:function(e){e.exports=JSON.parse('[{"Title":"Passage Through Mirkwood","Slug":"Passage-Through-Mirkwood","Product":"Core Set","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Journey Along the Anduin","Slug":"Journey-Along-the-Anduin","Product":"Core Set","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Escape from Dol Guldur","Slug":"Escape-from-Dol-Guldur","Product":"Core Set","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Oath","Slug":"The-Oath","Product":"Two-Player Limited Edition Starter","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Caves of Nibin-D\xfbm","Slug":"The-Caves-of-Nibin-D\xfbm","Product":"Two-Player Limited Edition Starter","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Hunt for Gollum","Slug":"The-Hunt-for-Gollum","Product":"The Hunt for Gollum","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Conflict at the Carrock","Slug":"Conflict-at-the-Carrock","Product":"Conflict at the Carrock","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"A Journey to Rhosgobel","Slug":"A-Journey-to-Rhosgobel","Product":"A Journey to Rhosgobel","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Hills of Emyn Muil","Slug":"The-Hills-of-Emyn-Muil","Product":"The Hills of Emyn Muil","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Dead Marshes","Slug":"The-Dead-Marshes","Product":"The Dead Marshes","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"Return to Mirkwood","Slug":"Return-to-Mirkwood","Product":"Return to Mirkwood","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Into the Pit","Slug":"Into-the-Pit","Product":"Khazad-d\xfbm","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Seventh Level","Slug":"The-Seventh-Level","Product":"Khazad-d\xfbm","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Flight from Moria","Slug":"Flight-from-Moria","Product":"Khazad-d\xfbm","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Redhorn Gate","Slug":"The-Redhorn-Gate","Product":"The Redhorn Gate","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Road to Rivendell","Slug":"Road-to-Rivendell","Product":"Road to Rivendell","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Watcher in the Water","Slug":"The-Watcher-in-the-Water","Product":"The Watcher in the Water","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Long Dark","Slug":"The-Long-Dark","Product":"The Long Dark","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"Foundations of Stone","Slug":"Foundations-of-Stone","Product":"Foundations of Stone","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"Shadow and Flame","Slug":"Shadow-and-Flame","Product":"Shadow and Flame","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Peril in Pelargir","Slug":"Peril-in-Pelargir","Product":"Heirs of N\xfamenor","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Into Ithilien","Slug":"Into-Ithilien","Product":"Heirs of N\xfamenor","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Siege of Cair Andros","Slug":"The-Siege-of-Cair-Andros","Product":"Heirs of N\xfamenor","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Steward\'s Fear","Slug":"The-Steward\'s-Fear","Product":"The Steward\'s Fear","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Dr\xfaadan Forest","Slug":"The-Dr\xfaadan-Forest","Product":"The Dr\xfaadan Forest","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Encounter at Amon D\xeen","Slug":"Encounter-at-Amon-D\xeen","Product":"Encounter at Amon D\xeen","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"Assault on Osgiliath","Slug":"Assault-on-Osgiliath","Product":"Assault on Osgiliath","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Blood of Gondor","Slug":"The-Blood-of-Gondor","Product":"The Blood of Gondor","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Morgul Vale","Slug":"The-Morgul-Vale","Product":"The Morgul Vale","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Fords of Isen","Slug":"The-Fords-of-Isen","Product":"The Voice of Isengard","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"To Catch an Orc","Slug":"To-Catch-an-Orc","Product":"The Voice of Isengard","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Into Fangorn","Slug":"Into-Fangorn","Product":"The Voice of Isengard","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Dunland Trap","Slug":"The-Dunland-Trap","Product":"The Dunland Trap","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Three Trials","Slug":"The-Three-Trials","Product":"The Three Trials","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Trouble in Tharbad","Slug":"Trouble-in-Tharbad","Product":"Trouble in Tharbad","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The N\xeen-in-Eilph","Slug":"The-N\xeen-in-Eilph","Product":"The N\xeen-in-Eilph","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"Celebrimbor\'s Secret","Slug":"Celebrimbor\'s-Secret","Product":"Celebrimbor\'s Secret","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Antlered Crown","Slug":"The-Antlered-Crown","Product":"The Antlered Crown","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Intruders in Chetwood","Slug":"Intruders-in-Chetwood","Product":"The Lost Realm","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Weather Hills","Slug":"The-Weather-Hills","Product":"The Lost Realm","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Deadmen\'s Dike","Slug":"Deadmen\'s-Dike","Product":"The Lost Realm","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Wastes of Eriador","Slug":"The-Wastes-of-Eriador","Product":"The Wastes of Eriador","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Escape from Mount Gram","Slug":"Escape-from-Mount-Gram","Product":"Escape from Mount Gram","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Across the Ettenmoors","Slug":"Across-the-Ettenmoors","Product":"Across the Ettenmoors","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Treachery of Rhudaur","Slug":"The-Treachery-of-Rhudaur","Product":"Treachery of Rhudaur","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Battle of Carn D\xfbm","Slug":"The-Battle-of-Carn-D\xfbm","Product":"The Battle of Carn D\xfbm","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Dread Realm","Slug":"The-Dread-Realm","Product":"The Dread Realm","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Voyage Across Belegaer","Slug":"Voyage-Across-Belegaer","Product":"The Grey Havens","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Fate of N\xfamenor","Slug":"The-Fate-of-N\xfamenor","Product":"The Grey Havens","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Raid on the Grey Havens","Slug":"Raid-on-the-Grey-Havens","Product":"The Grey Havens","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"Flight of the Stormcaller","Slug":"Flight-of-the-Stormcaller","Product":"Flight of the Stormcaller","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Thing in the Depths","Slug":"The-Thing-in-the-Depths","Product":"The Thing in the Depths","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Temple of the Deceived","Slug":"Temple-of-the-Deceived","Product":"Temple of the Deceived","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Drowned Ruins","Slug":"The-Drowned-Ruins","Product":"The Drowned Ruins","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"A Storm on Cobas Haven","Slug":"A-Storm-on-Cobas-Haven","Product":"A Storm on Cobas Haven","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The City of Corsairs","Slug":"The-City-of-Corsairs","Product":"The City of Corsairs","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Escape from Umbar","Slug":"Escape-from-Umbar","Product":"The Sands of Harad","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Desert Crossing","Slug":"Desert-Crossing","Product":"The Sands of Harad","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Long Arm of Mordor","Slug":"The-Long-Arm-of-Mordor","Product":"The Sands of Harad","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The M\xfbmakil","Slug":"The-M\xfbmakil","Product":"The M\xfbmakil","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Race Across Harad","Slug":"Race-Across-Harad","Product":"Race Across Harad","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Beneath the Sands","Slug":"Beneath-the-Sands","Product":"Beneath the Sands","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Black Serpent","Slug":"The-Black-Serpent","Product":"The Black Serpent","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Dungeons of Cirith Gurat","Slug":"The-Dungeons-of-Cirith-Gurat","Product":"The Dungeons of Cirith Gurat","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Crossings of Poros","Slug":"The-Crossings-of-Poros","Product":"The Crossings of Poros","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Journey Up the Anduin","Slug":"Journey-Up-the-Anduin","Product":"The Wilds of Rhovanion","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Lost in Mirkwood","Slug":"Lost-in-Mirkwood","Product":"The Wilds of Rhovanion","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The King\'s Quest","Slug":"The-King\'s-Quest","Product":"The Wilds of Rhovanion","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Withered Heath","Slug":"The-Withered-Heath","Product":"The Withered Heath","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"Roam Across Rhovanion","Slug":"Roam-Across-Rhovanion","Product":"Roam Across Rhovanion","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"Fire in the Night","Slug":"Fire-in-the-Night","Product":"Fire in the Night","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Ghost of Framsburg","Slug":"The-Ghost-of-Framsburg","Product":"The Ghost of Framsburg","Number":7,"QuestCards":[],"ScenarioCards":[]},{"Title":"Mount Gundabad","Slug":"Mount-Gundabad","Product":"Mount Gundabad","Number":8,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Fate of Wilderland","Slug":"The-Fate-of-Wilderland","Product":"The Fate of Wilderland","Number":9,"QuestCards":[],"ScenarioCards":[]},{"Title":"The River Running","Slug":"The-River-Running","Product":"A Shadow in the East","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Danger in Dorwinion","Slug":"Danger-in-Dorwinion","Product":"A Shadow in the East","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Temple of Doom","Slug":"Temple-of-Doom","Product":"A Shadow in the East","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"Wrath and Ruin","Slug":"Wrath-and-Ruin","Product":"Wrath and Ruin","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The City of Ulfast","Slug":"The-City-of-Ulfast","Product":"The City of Ulfast","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Challenge of the Wainriders","Slug":"Challenge-of-the-Wainriders","Product":"Challenge of the Wainriders","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"Under the Ash Mountains","Slug":"Under-the-Ash-Mountains","Product":"Under the Ash Mountains","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Land of Sorrow","Slug":"The-Land-of-Sorrow","Product":"The Land of Sorrow","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Fortress of Nurn","Slug":"The-Fortress-of-Nurn","Product":"The Fortress of Nurn","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"We Must Away, Ere Break of Day","Slug":"We-Must-Away,-Ere-Break-of-Day","Product":"The Hobbit: Over Hill and Under Hill","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Over the Misty Mountains Grim","Slug":"Over-the-Misty-Mountains-Grim","Product":"The Hobbit: Over Hill and Under Hill","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Dungeons Deep and Caverns Dim","Slug":"Dungeons-Deep-and-Caverns-Dim","Product":"The Hobbit: Over Hill and Under Hill","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"Flies and Spiders","Slug":"Flies-and-Spiders","Product":"The Hobbit: On the Doorstep","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Lonely Mountain","Slug":"The-Lonely-Mountain","Product":"The Hobbit: On the Doorstep","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Battle of Five Armies","Slug":"The-Battle-of-Five-Armies","Product":"The Hobbit: On the Doorstep","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"A Shadow of the Past","Slug":"A-Shadow-of-the-Past","Product":"The Black Riders","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"A Knife in the Dark","Slug":"A-Knife-in-the-Dark","Product":"The Black Riders","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"Flight to the Ford","Slug":"Flight-to-the-Ford","Product":"The Black Riders","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Ring Goes South","Slug":"The-Ring-Goes-South","Product":"The Road Darkens","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"Journey in the Dark","Slug":"Journey-in-the-Dark","Product":"The Road Darkens","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"Breaking of the Fellowship","Slug":"Breaking-of-the-Fellowship","Product":"The Road Darkens","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Uruk-hai","Slug":"The-Uruk-hai","Product":"The Treason of Saruman","Number":7,"QuestCards":[],"ScenarioCards":[]},{"Title":"Helm\'s Deep","Slug":"Helm\'s-Deep","Product":"The Treason of Saruman","Number":8,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Road to Isengard","Slug":"The-Road-to-Isengard","Product":"The Treason of Saruman","Number":9,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Passage of the Marshes","Slug":"The-Passage-of-the-Marshes","Product":"The Land of Shadow","Number":10,"QuestCards":[],"ScenarioCards":[]},{"Title":"Journey to the Cross-roads","Slug":"Journey-to-the-Cross-roads","Product":"The Land of Shadow","Number":11,"QuestCards":[],"ScenarioCards":[]},{"Title":"Shelob\'s Lair","Slug":"Shelob\'s-Lair","Product":"The Land of Shadow","Number":12,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Passing of the Grey Company","Slug":"The-Passing-of-the-Grey-Company","Product":"The Flame of the West","Number":13,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Siege of Gondor","Slug":"The-Siege-of-Gondor","Product":"The Flame of the West","Number":14,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Battle of the Pelennor Fields","Slug":"The-Battle-of-the-Pelennor-Fields","Product":"The Flame of the West","Number":15,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Tower of Cirith Ungol","Slug":"The-Tower-of-Cirith-Ungol","Product":"The Mountain of Fire","Number":16,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Black Gate Opens","Slug":"The-Black-Gate-Opens","Product":"The Mountain of Fire","Number":17,"QuestCards":[],"ScenarioCards":[]},{"Title":"Mount Doom","Slug":"Mount-Doom","Product":"The Mountain of Fire","Number":18,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Massing at Osgiliath","Slug":"The-Massing-at-Osgiliath","Product":"2011","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Battle of Lake-town","Slug":"The-Battle-of-Lake-town","Product":"2012","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Stone of Erech","Slug":"The-Stone-of-Erech","Product":"2013","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Old Forest","Slug":"The-Old-Forest","Product":"2014","Number":4,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Ruins of Belegost","Slug":"The-Ruins-of-Belegost","Product":"2015","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"Fog on the Barrow-downs","Slug":"Fog-on-the-Barrow-downs","Product":"2014","Number":5,"QuestCards":[],"ScenarioCards":[]},{"Title":"Murder at the Prancing Pony","Slug":"Murder-at-the-Prancing-Pony","Product":"2015","Number":6,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Siege of Ann\xfaminas","Slug":"The-Siege-of-Ann\xfaminas","Product":"2016","Number":7,"QuestCards":[],"ScenarioCards":[]},{"Title":"Attack on Dol Guldur","Slug":"Attack-on-Dol-Guldur","Product":"2017","Number":8,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Hunt for the Dreadnaught","Slug":"The-Hunt-for-the-Dreadnaught","Product":"The Hunt for the Dreadnaught","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Hunting of the Wolf","Slug":"Hunting-of-the-Wolf","Product":"First Age","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Isle of Werewolves","Slug":"The-Isle-of-Werewolves","Product":"First Age","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Seat of Morgoth","Slug":"The-Seat-of-Morgoth","Product":"First Age","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"Trial Upon the Marches","Slug":"Trial-Upon-the-Marches","Product":"Trial Upon the Marches","Number":1,"QuestCards":[],"ScenarioCards":[]},{"Title":"Among the Outlaws","Slug":"Among-the-Outlaws","Product":"Among the Outlaws","Number":2,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Betrayal of M\xeem","Slug":"The-Betrayal-of-M\xeem","Product":"The Betrayal of M\xeem","Number":3,"QuestCards":[],"ScenarioCards":[]},{"Title":"The Fall of Nargothrond","Slug":"The-Fall-of-Nargothrond","Product":"The Fall of Nargothrond","Number":4,"QuestCards":[],"ScenarioCards":[]}]')}},[[281,1,2]]]);
//# sourceMappingURL=main.84f1769b.chunk.js.map